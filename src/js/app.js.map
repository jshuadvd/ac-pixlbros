{"version":3,"sources":["index.js"],"names":["siteConfig","siteURL","shareText","siteTweet","assetShare","assetTweet","position","lon","curPosX","fovMin","fovMax","onPointerDownPointerX","onPointerDownLon","blocked","touchStartX","showLoader","bar","ProgressBar","Path","easing","duration","set","percent","int","setInterval","clearInterval","animate","TweenMax","to","$","autoAlpha","display","fixed","toFixed","html","hide","setupButtons","each","$el","clone","find","attr","append","after","on","key","console","log","buttons","event","currentTarget","Modal","hotspot","modal","item","content","description","title","facebookShare","twitterShare","nextButton","prevButton","bindEvents","prototype","next","prev","shareFacebook","shareTwitter","onComplete","offset","slides","length","setModalValues","slide","href","makeUrlParams","id","picture","image","FB","ui","method","replace","response","params","encodeURIComponent","url","text","hashtags","window","open","showSliderControls","fadeIn","freeze","i","showingModal","camera","fov","document","off","show","subid","activeSlide","css","top","keyCode","audio","Audio","playAudio","ready","index","el","get","handleButtonClick","offLine","container","parents","pause","play","color","controls","clock","delta","deviceControls","h","info","logoGeo","logoMaterial","logoMesh","logoTexture","marker","mesh","materials","mouse","mousePos","objects","parameters","particles","particleMaterial","rainDensity","rainGeometry","raycaster","renderer","scene","size","smokeParticles","spotLight","spotLightHelper","sprite","stats","layer","hsParticles","rotateSpeed","hotspots","hotspotObjects","onMouseDownMouseX","onMouseDownMouseY","onMouseDownLon","lat","onMouseDownLat","phi","theta","getElementById","containerWidth","clientWidth","containerHeight","clientHeight","selectedObjects","loader","renderPass","outlinePass","composer","effectFXAA","initialOrientation","isUserInteracting","projector","THREE","Projector","mouseVector","Vector3","currentHotspot","touchDevice","DocumentTouch","init","width","innerWidth","height","innerHeight","devicePixelRatio","WebGLRenderer","antialias","shadowMap","enabled","setClearColor","setPixelRatio","setSize","PerspectiveCamera","target","Scene","geometry","SphereGeometry","scale","material","MeshBasicMaterial","map","TextureLoader","load","fog","Mesh","name","add","initStats","Raycaster","Vector2","buildHotspots","DeviceOrientationController","domElement","connect","setupControllerEventHandlers","Clock","EffectComposer","RenderPass","addPass","OutlinePass","edgeStrength","edgeGlow","edgeThickness","pulsePeriod","visibleEdgeColor","r","g","b","onLoad","texture","patternTexture","wrapS","RepeatWrapping","wrapT","lod","ShaderPass","FXAAShader","uniforms","value","renderToScreen","appendChild","addEventListener","onDocumentMouseDown","onDocumentMouseMove","onDocumentMouseUp","onDocumentTouchStart","onDocumentTouchMove","onWindowResize","orientCamera","body","getUrlParams","urlParams","match","pl","search","decode","s","decodeURIComponent","query","location","substring","exec","parseInt","filter","buttonClicks","JSONLoader","hotspotObject","center","oldMat","opacity","box","Box3","setFromObject","x","y","z","rotation","Math","PI","hitboxGeo","BoxBufferGeometry","getSize","hitboxMat","visible","hitboxMesh","hotspotLocation","group","Group","aspect","updateProjectionMatrix","touches","touch","pageX","checkRaycasterCollisions","pageY","preventDefault","addSelectedObject","object","push","mouse3D","setFromCamera","intersects","intersectObjects","children","items","intersect","forEach","parent","indexOf","addClass","removeClass","str","undefined","tweenArc","start","end","relativity","absDelta","abs","isTouch","so","currentLon","hotspotLon","data","maxDelta","maxDura","rotateHotspots","clientX","clientY","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","onDocumentMouseWheel","deltaY","requestAnimationFrame","update","max","min","degToRad","sin","cos","lookAt","getDelta","render","TweenLite","ticker","Stats","style","left","zIndex","controllerEl","querySelector","controllerDefaultText","textContent","controllerSelectorEl","compassCalibrationPopupEl","cursor","innerText","useQuaternions"],"mappings":"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KAA5B;;AAEA,OAAImL,kBAAkBnB,cAAcxQ,QAApC;;AAEA,OAAI4R,QAAQ,IAAIlH,MAAMmH,KAAV,EAAZ;AACAD,SAAMjF,IAAN,cAAsBnG,KAAtB;AACAoL,SAAM5R,QAAN,CAAee,GAAf,CAAmB4Q,gBAAgB,CAAhB,CAAnB,EAAuCA,gBAAgB,CAAhB,CAAvC,EAA2DA,gBAAgB,CAAhB,CAA3D;AACAlJ,SAAMmE,GAAN,CAAUgF,KAAV;AACAA,SAAMhF,GAAN,CAAU9J,OAAV;AACA8O,SAAMhF,GAAN,CAAU8E,UAAV;;AAEA,UAAOE,KAAP;AAEA,GA5CU,CAAX;AA6CA,EAjDD;AAkDA;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASvC,cAAT,GAA0B;AACzB,KAAInE,QAAQ/F,OAAOgG,UAAP,IAAqB,CAAjC;AACA,KAAIC,SAASjG,OAAOkG,WAAP,IAAsB,CAAnC;AACA,KAAIC,mBAAmBnG,OAAOmG,gBAAP,IAA2B,CAAlD;AACA5F,QAAOoM,MAAP,GAAgB5G,QAAQE,MAAxB;AACA1F,QAAOqM,sBAAP;AACAvJ,UAASqD,OAAT,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","file":"app.js","sourcesContent":["let siteConfig = {\n\tsiteURL: 'http://numinoustechnologies.com/animus/',\n\tshareText: 'Welcome to the Animus. Enter the 360º experience and discover the weapons and armor of the Assassins and Templars.',\n\tsiteTweet: 'Welcome to the Animus. Enter the 360º experience and discover the weapons and armor of the Assassins and Templars. #AssassinsCreed [URL]',\n\tassetShare: 'I entered the 360º Animus and discovered the [Object Name], an ancient artifact of Assassins\\' lore. Enter the Animus now to uncover ancient Assassins and Templar relics.',\n\tassetTweet: 'I entered the 360º Animus and discovered the [Object Name].'\n}\n\nlet position = {\n\tlon: 30\n}\nlet curPosX = 30;\nlet fovMin = 75;\nlet fovMax = 50;\nlet onPointerDownPointerX;\nlet onPointerDownLon;\nlet blocked = false;\nlet touchStartX;\n\n//************************************************************************//\n//                             Init Loader                                //\n//************************************************************************//\n\nlet showLoader = false;\n\nif(showLoader) {\n\tvar bar = new ProgressBar.Path('.st0', {\n\t\teasing: 'easeInOut',\n\t\tduration: 800\n\t});\n\tbar.set(0)\n\n\tlet percent = 0.1\n\tlet int = setInterval(function() {\n\t\tpercent += 0.1;\n\t\tif(percent >= 1.0) {\n\t\t\tclearInterval(int);\n\t\t} else {\n\t\t\tbar.animate(percent, () => {\n\t\t\t\tTweenMax.to($('#loader') , 0.3, {autoAlpha: 0, display: 'none'});\n\t\t\t});\n\t\t\tlet fixed = (percent*100).toFixed(0);\n\t\t\t$('text').html(`${fixed}%`)\n\t\t}\n\t}, 500)\n\n\t// THREE.DefaultLoadingManager.onProgress = function ( item, loaded, total ) {\n\t// \tlet percent = loaded/total\n\t// \tbar.animate(percent, function() {\n\t// \t\tTweenMax.to($('#loader') , 0.3, {autoAlpha: 0, display: 'none'});\n\t// \t});\n\t// \tlet fixed = (percent*100).toFixed(0);\n\t// \t$('text').html(`${fixed}%`);\n\t// };\n} else {\n\t$('#loader').hide();\n}\n\nfunction setupButtons() {\n\t$('.button-outer .logo').each(function() {\n\t\tvar $el = $(this);\n\t\tvar clone = $el.find('.clone').clone().attr('class', 'fill blur');\n\t\t$el.append(clone);\n\t});\n\t$('.inner-path').each(function() {\n\t\tvar $el = $(this);\n\t\tvar clone = $el.clone().attr('class', 'blur');\n\t\t$el.after(clone);\n\t});\n\t$('.button-outer').on('mouseenter', function() {\n\t\tvar key = $(this).attr('key');\n\t\tconsole.log('moustenter', key);\n\t\tbuttons[key].animate(1);\n\t});\n\t$('.button-outer').on('mouseleave', (event) => {\n\t\tvar key = $(event.currentTarget).attr('key');\n\t\tbuttons[key].set(0);\n\t});\n}\n\nvar buttons = {};\n\n\n//************************************************************************//\n//                             Init Audio                                 //\n//************************************************************************//\n\n// let audio = document.createElement('audio');\n// let source = document.createElement('source');\n// source.src = 'audio/AC-Trailer.mp3';\n// audio.appendChild(source);\n// audio.play();\n\nfunction Modal(hotspot) {\n\tthis.modal = $('.modal');\n\tthis.item = this.modal.find('.item');\n\tthis.content = this.modal.find('.content');\n\tthis.description = this.modal.find('.description');\n\tthis.title = this.modal.find('.title');\n\tthis.facebookShare = this.modal.find('.button-outer.fb');\n\tthis.twitterShare = this.modal.find('.button-outer.twitter');\n\tthis.nextButton = this.modal.find('.next');\n\tthis.prevButton = this.modal.find('.prev');\n\t$('.modal-container .close').on('click', () => {\n\t\tthis.hide();\n\t});\n\t$('.overlay').on('click', this.hide);\n\tthis.bindEvents();\n}\n\nModal.prototype = {\n\tbindEvents() {\n\t\tthis.nextButton.on('click', () => {\n\t\t\tthis.next();\n\t\t});\n\n\t\tthis.prevButton.on('click', () => {\n\t\t\tthis.prev();\n\t\t});\n\t\tthis.facebookShare.on('click', () => {\n\t\t\tthis.shareFacebook();\n\t\t});\n\t\tthis.twitterShare.on('click', () => {\n\t\t\tthis.shareTwitter();\n\t\t});\n\t},\n\tprev() {\n\t\tlet content = this.content;\n\t\tlet duration = this.duration;\n\t\tTweenMax.to(content, duration, {autoAlpha: 0, onComplete: () => {\n\t\t\tthis.offset = this.offset === 0 ? this.hotspot.slides.length-1 : this.offset-1;\n\t\t\tthis.setModalValues(this.hotspot.slides[this.offset]);\n\t\t\tTweenMax.to(content, duration, {autoAlpha: 1});\n\t\t}});\n\t},\n\tnext() {\n\t\tlet content = this.content;\n\t\tlet duration = this.duration;\n\t\tTweenMax.to(content, duration, {autoAlpha: 0, onComplete: () => {\n\t\t\tthis.offset = this.offset+1 === this.hotspot.slides.length ? 0 : this.offset+1;\n\t\t\tthis.setModalValues(this.hotspot.slides[this.offset]);\n\t\t\tTweenMax.to(content, duration, {autoAlpha: 1});\n\t\t}})\n\t},\n\t// share: {\n\t\tshareFacebook() {\n\t\t\tconsole.log(this, this.hotspot, this.offset);\n\t\t\tlet slide = this.hotspot.slides[this.offset];\n\t\t\tlet href = `${siteConfig.siteURL}${makeUrlParams(this.hotspot.id, this.offset)}`;\n\t\t\tlet picture = `${siteConfig.siteURL}${slide.image}`;\n\t\t\tconsole.log('p', picture);\n\t\t\tconsole.log('href', href);\n\t\t\tFB.ui(\n\t\t\t{\n\t\t\t\tmethod: 'share',\n\t\t\t\thref: href,\n\t\t\t\ttitle: slide.title,\n\t\t\t\tpicture: picture,\n\t\t\t\t// caption: 'your_caption',\n\t\t\t\tdescription: siteConfig.assetShare.replace('[Object Name]', slide.title)\n\t\t\t },\n\t\t\t function(response){\n\t\t\t\t// your code to manage the response\n\t\t\t });\n\t\t},\n\t\tshareTwitter() {\n\t\t\t\n\t\t\tlet params = encodeURIComponent(makeUrlParams(this.hotspot.id, this.offset));\n\t\t\tlet url = `${siteConfig.siteURL}${params}`;\n\t\t\tlet slide = this.hotspot.slides[this.offset];\n\t\t\tlet text = siteConfig.assetTweet.replace('[Object Name]', slide.title)\n\t\t\t// .replace('[URL]', `${url}${params}`);\n\t\t\tlet hashtags = 'AssassinsCreed'\n\t\t\twindow.open(`http://twitter.com/intent/tweet?url=${url}&text=${text}&hashtags=${hashtags}`);\n\t\t},\n\t// },\n\tduration: 0.35,\n\toffset: 0,\n\tsetModalValues(hotspot) {\n\t\tconsole.log('setModalValues', hotspot);\n\t\tthis.description.text(hotspot.description);\n\t\tthis.title.text(hotspot.title);\n\t\tthis.item.attr('src', hotspot.image);\n\t\tthis.modal.attr('class', `modal ${hotspot.key}`);\n\t},\n\tshowSliderControls() {\n\t\t$('.modal .controls').fadeIn();\n\t},\n\thide() {\n\t\tfreeze = false;\n\t\tthis.modal.attr('class', 'modal');\n\t\tfor(var i in buttons) {\n\t\t\tbuttons[i].set(0);\n\t\t}\n\t\tlet duration = 550/1000\n\t\tshowingModal = false;\n\t\t// pointerLock();\n\t\tTweenMax.to($('.modal-container') , 0.3, {autoAlpha: 0})\n\t\tTweenMax.to(camera, duration, {fov: fovMin, onComplete: function() {\n\t\t\tblocked = false;\n\t\t}});\n\t\t$(document).off('keydown');\n\t},\n\tshow(hotspot, subid) {\n\t\tthis.hotspot = hotspot;\n\t\tthis.subid = subid;\n\t\tthis.offset = 0;\n\t\t// let urlParams = makeUrlParams(hotspot.id);\n\t\t// history.replaceState(null, null, urlParams);\n\t\tlet duration = 550/1000;\n\t\tshowingModal = true;\n\t\tif(hotspot.slides && hotspot.slides.length > 0) {\n\t\t\tthis.showSliderControls();\n\t\t\tthis.activeSlide = hotspot.slides[this.offset];\n\t\t\tthis.setModalValues(this.activeSlide);\n\t\t}\n\t\tTweenMax.to($('.modal-container') , 0.3, {autoAlpha: 1})\n\t\tTweenMax.to(camera, duration, {fov: fovMax, onComplete: () => {\n\t\t\t$('.modal-container').css({top: 0})\n\t\t\t$(document).on('keydown', (event) => {\n\t\t\t\tif(event.keyCode === 27) {\n\t\t\t\t\tmodal.hide();\n\t\t\t\t} \n\t\t\t});\n\t\t}})\n\t}\n}\nlet modal = new Modal();\nmodal.bindEvents();\n\nlet audio = new Audio('audio/AC-Trailer.mp3');\n// audio.play();\n\nlet playAudio = true;\n\n// herp derp\n\n$(document).ready(function() {\n\n\t$('.button-outer').each((index, el) => {\n\t\tvar $el = $(el);\n\t\tvar key = $el.attr('key');\n\t\tbuttons[key] = new ProgressBar.Path($el.find('.outer-path').get(0), {\n\t\t\teasing: 'easeInOut',\n\t\t\tduration: 500\n\t\t});\n\t\tbuttons[key].set(0);\n\t});\n\n\t$('.button-outer').on('mouseenter', function() {\n\t\tvar key = $(this).attr('key');\n\t\tconsole.log('moustenter', key);\n\t\tbuttons[key].animate(1);\n\t\t// $(this).find('.outer-path').data('progress')\n\t});\n\n\t$('.button-outer').on('mouseleave', (event) => {\n\t\tvar key = $(event.currentTarget).attr('key');\n\t\tbuttons[key].set(0);\n\t\t// $(event.currentTarget).find('.outer-path').data('progress').set(0);\n\t});\n\n\t$('.button-outer').on('click', (event) => {\n\t\tvar key = $(event.currentTarget).attr('key');\n\t\thandleButtonClick(key);\n\t});\n\n\tlet offLine = $('.sound line');\n\tlet container = offLine.parents('svg');\n\t$('.sound').on('click', () => {\n\t\tif(playAudio) {\n\t\t\taudio.pause();\n\t\t\toffLine.show();\n\t\t\tcontainer.attr('class', 'off');\n\t\t} else {\n\t\t\taudio.play();\n\t\t\toffLine.hide();\n\t\t\tcontainer.attr('class', '');\n\t\t}\n\t\tplayAudio = !playAudio;\n\t});\n\n\tsetupButtons();\n});\n\n//************************************************************************//\n//                              Variables                           \t  //\n//************************************************************************//\n\nlet camera, container, color, controls, clock, delta, deviceControls, h, hotspot, info, logoGeo, logoMaterial, logoMesh, logoTexture, marker, mesh, materials = [], mouse, mousePos, objects = [], parameters, particles, particleMaterial, rainDensity = 20000, rainGeometry, raycaster, renderer, scene, size, smokeParticles = [], spotLight, spotLightHelper, sprite, stats; \nlet layer = false;\nlet hsParticles = [];\nlet rotateSpeed = 0.03\nlet hotspots = [];\nlet hotspotObjects = [\n\t{\n\t\tid: 0,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'BLADED SPEAR de BILBOA',\n\t\t\t\tdescription: 'This bladed spear is sure to keep enemies at bay. with a heavy ash base and a finely hewn blade forged by bilboan craftsmen, in the hands of an assassin this weapon can defeat an entire batallion of templar enemies.',\n\t\t\t\timage: 'textures/bladed-spear.png',\n\t\t\t\tkey: 'bladed-spear'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'LEATHER ASSASSIN VAMBRACE',\n\t\t\t\tdescription: 'the leather vambrace as an essential piece of every assassin’s armor. this blade- concealing armor both proects from attacks and gives the assassin access to a hidden blade with a simple flick of the wrist.',\n\t\t\t\timage: 'textures/vambrace.png',\n\t\t\t\tkey: 'vambrace'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'CóRDOBAN HALBERD',\n\t\t\t\tdescription: 'the córdoban halberd combines the intricate artistrty of the monarchy with the unparalleled killing power of the inquisition. featuring tempered steel and ornate gold gilding in the staff, this weapon is both beautiful and deadly.',\n\t\t\t\timage: 'textures/halberd.png',\n\t\t\t\tkey: 'halberd'\n\t\t\t}\n\t\t],\n\t\tlon: 19,\n\t\tposition: [450, 0, 150],\n\t},\n\t{\n\t\tid: 1,\n\t\tlon: 39,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'BLADED SPEAR de BILBOA',\n\t\t\t\tdescription: 'This bladed spear is sure to keep enemies at bay. with a heavy ash base and a finely hewn blade forged by bilboan craftsmen, in the hands of an assassin this weapon can defeat an entire batallion of templar enemies.',\n\t\t\t\timage: 'textures/bladed-spear.png',\n\t\t\t\tkey: 'bladed-spear'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'LEATHER ASSASSIN VAMBRACE',\n\t\t\t\tdescription: 'the leather vambrace as an essential piece of every assassin’s armor. this blade- concealing armor both proects from attacks and gives the assassin access to a hidden blade with a simple flick of the wrist.',\n\t\t\t\timage: 'textures/vambrace.png',\n\t\t\t\tkey: 'vambrace'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'CóRDOBAN HALBERD',\n\t\t\t\tdescription: 'the córdoban halberd combines the intricate artistrty of the monarchy with the unparalleled killing power of the inquisition. featuring tempered steel and ornate gold gilding in the staff, this weapon is both beautiful and deadly.',\n\t\t\t\timage: 'textures/halberd.png',\n\t\t\t\tkey: 'halberd'\n\t\t\t}\n\t\t],\n\t\tposition: [370, 0, 280],\n\t},\n\t{\n\t\tid: 2,\n\t\tlon: 87.5,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'BLADED SPEAR de BILBOA',\n\t\t\t\tdescription: 'This bladed spear is sure to keep enemies at bay. with a heavy ash base and a finely hewn blade forged by bilboan craftsmen, in the hands of an assassin this weapon can defeat an entire batallion of templar enemies.',\n\t\t\t\timage: 'textures/bladed-spear.png',\n\t\t\t\tkey: 'bladed-spear'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'LEATHER ASSASSIN VAMBRACE',\n\t\t\t\tdescription: 'the leather vambrace as an essential piece of every assassin’s armor. this blade- concealing armor both proects from attacks and gives the assassin access to a hidden blade with a simple flick of the wrist.',\n\t\t\t\timage: 'textures/vambrace.png',\n\t\t\t\tkey: 'vambrace'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'CóRDOBAN HALBERD',\n\t\t\t\tdescription: 'the córdoban halberd combines the intricate artistrty of the monarchy with the unparalleled killing power of the inquisition. featuring tempered steel and ornate gold gilding in the staff, this weapon is both beautiful and deadly.',\n\t\t\t\timage: 'textures/halberd.png',\n\t\t\t\tkey: 'halberd'\n\t\t\t}\n\t\t],\n\t\tposition: [25, 0, 400],\n\t},\n\t{\n\t\tid: 3,\n\t\tlon: 106,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'BLADED SPEAR de BILBOA',\n\t\t\t\tdescription: 'This bladed spear is sure to keep enemies at bay. with a heavy ash base and a finely hewn blade forged by bilboan craftsmen, in the hands of an assassin this weapon can defeat an entire batallion of templar enemies.',\n\t\t\t\timage: 'textures/bladed-spear.png',\n\t\t\t\tkey: 'bladed-spear'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'LEATHER ASSASSIN VAMBRACE',\n\t\t\t\tdescription: 'the leather vambrace as an essential piece of every assassin’s armor. this blade- concealing armor both proects from attacks and gives the assassin access to a hidden blade with a simple flick of the wrist.',\n\t\t\t\timage: 'textures/vambrace.png',\n\t\t\t\tkey: 'vambrace'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'CóRDOBAN HALBERD',\n\t\t\t\tdescription: 'the córdoban halberd combines the intricate artistrty of the monarchy with the unparalleled killing power of the inquisition. featuring tempered steel and ornate gold gilding in the staff, this weapon is both beautiful and deadly.',\n\t\t\t\timage: 'textures/halberd.png',\n\t\t\t\tkey: 'halberd'\n\t\t\t}\n\t\t],\n\t\tposition: [-115, 0, 400],\n\t},\n\t{\n\t\tid: 4,\n\t\tlon: 153,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'BLADED SPEAR de BILBOA',\n\t\t\t\tdescription: 'This bladed spear is sure to keep enemies at bay. with a heavy ash base and a finely hewn blade forged by bilboan craftsmen, in the hands of an assassin this weapon can defeat an entire batallion of templar enemies.',\n\t\t\t\timage: 'textures/bladed-spear.png',\n\t\t\t\tkey: 'bladed-spear'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'LEATHER ASSASSIN VAMBRACE',\n\t\t\t\tdescription: 'the leather vambrace as an essential piece of every assassin’s armor. this blade- concealing armor both proects from attacks and gives the assassin access to a hidden blade with a simple flick of the wrist.',\n\t\t\t\timage: 'textures/vambrace.png',\n\t\t\t\tkey: 'vambrace'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'CóRDOBAN HALBERD',\n\t\t\t\tdescription: 'the córdoban halberd combines the intricate artistrty of the monarchy with the unparalleled killing power of the inquisition. featuring tempered steel and ornate gold gilding in the staff, this weapon is both beautiful and deadly.',\n\t\t\t\timage: 'textures/halberd.png',\n\t\t\t\tkey: 'halberd'\n\t\t\t}\n\t\t],\n\t\tposition: [-400, 0, 205],\n\t},\n\t{\n\t\tid: 5,\n\t\tlon: 175,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'BLADED SPEAR de BILBOA',\n\t\t\t\tdescription: 'This bladed spear is sure to keep enemies at bay. with a heavy ash base and a finely hewn blade forged by bilboan craftsmen, in the hands of an assassin this weapon can defeat an entire batallion of templar enemies.',\n\t\t\t\timage: 'textures/bladed-spear.png',\n\t\t\t\tkey: 'bladed-spear'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'LEATHER ASSASSIN VAMBRACE',\n\t\t\t\tdescription: 'the leather vambrace as an essential piece of every assassin’s armor. this blade- concealing armor both proects from attacks and gives the assassin access to a hidden blade with a simple flick of the wrist.',\n\t\t\t\timage: 'textures/vambrace.png',\n\t\t\t\tkey: 'vambrace'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'CóRDOBAN HALBERD',\n\t\t\t\tdescription: 'the córdoban halberd combines the intricate artistrty of the monarchy with the unparalleled killing power of the inquisition. featuring tempered steel and ornate gold gilding in the staff, this weapon is both beautiful and deadly.',\n\t\t\t\timage: 'textures/halberd.png',\n\t\t\t\tkey: 'halberd'\n\t\t\t}\n\t\t],\n\t\tposition: [-445, 0, 30],\n\t},\n\t{\n\t\tid: 6,\n\t\tlon: 236,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'BLADED SPEAR de BILBOA',\n\t\t\t\tdescription: 'This bladed spear is sure to keep enemies at bay. with a heavy ash base and a finely hewn blade forged by bilboan craftsmen, in the hands of an assassin this weapon can defeat an entire batallion of templar enemies.',\n\t\t\t\timage: 'textures/bladed-spear.png',\n\t\t\t\tkey: 'bladed-spear'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'LEATHER ASSASSIN VAMBRACE',\n\t\t\t\tdescription: 'the leather vambrace as an essential piece of every assassin’s armor. this blade- concealing armor both proects from attacks and gives the assassin access to a hidden blade with a simple flick of the wrist.',\n\t\t\t\timage: 'textures/vambrace.png',\n\t\t\t\tkey: 'vambrace'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'CóRDOBAN HALBERD',\n\t\t\t\tdescription: 'the córdoban halberd combines the intricate artistrty of the monarchy with the unparalleled killing power of the inquisition. featuring tempered steel and ornate gold gilding in the staff, this weapon is both beautiful and deadly.',\n\t\t\t\timage: 'textures/halberd.png',\n\t\t\t\tkey: 'halberd'\n\t\t\t}\n\t\t],\n\t\tposition: [-265, 0, -380],\n\t},\n\t{\n\t\tid: 7,\n\t\tlon: 262.5,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'BLADED SPEAR de BILBOA',\n\t\t\t\tdescription: 'This bladed spear is sure to keep enemies at bay. with a heavy ash base and a finely hewn blade forged by bilboan craftsmen, in the hands of an assassin this weapon can defeat an entire batallion of templar enemies.',\n\t\t\t\timage: 'textures/bladed-spear.png',\n\t\t\t\tkey: 'bladed-spear'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'LEATHER ASSASSIN VAMBRACE',\n\t\t\t\tdescription: 'the leather vambrace as an essential piece of every assassin’s armor. this blade- concealing armor both proects from attacks and gives the assassin access to a hidden blade with a simple flick of the wrist.',\n\t\t\t\timage: 'textures/vambrace.png',\n\t\t\t\tkey: 'vambrace'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'CóRDOBAN HALBERD',\n\t\t\t\tdescription: 'the córdoban halberd combines the intricate artistrty of the monarchy with the unparalleled killing power of the inquisition. featuring tempered steel and ornate gold gilding in the staff, this weapon is both beautiful and deadly.',\n\t\t\t\timage: 'textures/halberd.png',\n\t\t\t\tkey: 'halberd'\n\t\t\t}\n\t\t],\n\t\tposition: [-60, 0, -455],\n\t},\n\t{\n\t\tid: 8,\n\t\tlon: 286.5,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'BLADED SPEAR de BILBOA',\n\t\t\t\tdescription: 'This bladed spear is sure to keep enemies at bay. with a heavy ash base and a finely hewn blade forged by bilboan craftsmen, in the hands of an assassin this weapon can defeat an entire batallion of templar enemies.',\n\t\t\t\timage: 'textures/bladed-spear.png',\n\t\t\t\tkey: 'bladed-spear'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'LEATHER ASSASSIN VAMBRACE',\n\t\t\t\tdescription: 'the leather vambrace as an essential piece of every assassin’s armor. this blade- concealing armor both proects from attacks and gives the assassin access to a hidden blade with a simple flick of the wrist.',\n\t\t\t\timage: 'textures/vambrace.png',\n\t\t\t\tkey: 'vambrace'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'CóRDOBAN HALBERD',\n\t\t\t\tdescription: 'the córdoban halberd combines the intricate artistrty of the monarchy with the unparalleled killing power of the inquisition. featuring tempered steel and ornate gold gilding in the staff, this weapon is both beautiful and deadly.',\n\t\t\t\timage: 'textures/halberd.png',\n\t\t\t\tkey: 'halberd'\n\t\t\t}\n\t\t],\n\t\tposition: [125, 0, -455],\n\t},\n\t{\n\t\tid: 9,\n\t\tlon: 332,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'BLADED SPEAR de BILBOA',\n\t\t\t\tdescription: 'This bladed spear is sure to keep enemies at bay. with a heavy ash base and a finely hewn blade forged by bilboan craftsmen, in the hands of an assassin this weapon can defeat an entire batallion of templar enemies.',\n\t\t\t\timage: 'textures/bladed-spear.png',\n\t\t\t\tkey: 'bladed-spear'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'LEATHER ASSASSIN VAMBRACE',\n\t\t\t\tdescription: 'the leather vambrace as an essential piece of every assassin’s armor. this blade- concealing armor both proects from attacks and gives the assassin access to a hidden blade with a simple flick of the wrist.',\n\t\t\t\timage: 'textures/vambrace.png',\n\t\t\t\tkey: 'vambrace'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'CóRDOBAN HALBERD',\n\t\t\t\tdescription: 'the córdoban halberd combines the intricate artistrty of the monarchy with the unparalleled killing power of the inquisition. featuring tempered steel and ornate gold gilding in the staff, this weapon is both beautiful and deadly.',\n\t\t\t\timage: 'textures/halberd.png',\n\t\t\t\tkey: 'halberd'\n\t\t\t}\n\t\t],\n\t\tposition: [400, 0, -205]\n\t},\n];\nlet onMouseDownMouseX = 0, onMouseDownMouseY = 0,\nonMouseDownLon = 0,\nlat = 0, onMouseDownLat = 0,\nphi = 0, theta = 0;\n\ncontainer = document.getElementById( 'container' );\n\nlet containerWidth = container.clientWidth;\nlet containerHeight = container.clientHeight;\n\nlet selectedObjects = [];\nlet loader;\nlet renderPass;\nlet outlinePass;\nlet composer;\nlet effectFXAA;\n// let controlsEnabled = true;\nlet showingModal = false;\nlet initialOrientation;\nlet isUserInteracting = false;\nlet freeze;\n\nlet projector = new THREE.Projector();\nlet mouseVector = new THREE.Vector3();\n\nlet currentHotspot;\n\nlet touchDevice\nif (('ontouchstart' in window) || window.DocumentTouch && document instanceof DocumentTouch) { \n\ttouchDevice = true;\n}\n\ninit();\nanimate();\n\n//************************************************************************//\n//                             Init Scene                                 //\n//************************************************************************//\n\nfunction init() {\n\n\tvar width = window.innerWidth || 1;\n\tvar height = window.innerHeight || 1;\n\tvar devicePixelRatio = window.devicePixelRatio || 1;\n\trenderer = new THREE.WebGLRenderer( { antialias: false } );\n\trenderer.shadowMap.enabled = true;\n\trenderer.setClearColor( 0xa0a0a0 );\n\trenderer.setPixelRatio( 1 );\n\trenderer.setSize( width, height );\n\n\tcamera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 1, 2000 );\n\tcamera.target = new THREE.Vector3( 0, 0, 0 );\n\tscene = new THREE.Scene();\n\n\tlet geometry = new THREE.SphereGeometry( 500, 60, 400 );\n\tgeometry.scale( - 1, 1, 1 );\n\n\tlet material = new THREE.MeshBasicMaterial( {\n\t\tmap: new THREE.TextureLoader().load( 'textures/AnimusPanorama_V2.jpg' ),\n\t\tfog: true,\n\t});\n\t\n\tmesh = new THREE.Mesh( geometry, material );\n\tmesh.name = 'scene';\n\tscene.add( mesh );\n\t\n\tstats = initStats()\n\t\n\traycaster = new THREE.Raycaster();\n\tmouse = new THREE.Vector2();\n\t\n\t// Build items for raycaster clicks\n\tbuildHotspots();\n\t\n\t// Device Orientation Stuff\n\tdeviceControls = new DeviceOrientationController( camera, renderer.domElement );\n\tdeviceControls.connect()\n\tsetupControllerEventHandlers( deviceControls )\n\n\t// if (window.DeviceOrientationEvent) {\n\t// \tconsole.log(\"Wonderful, Our browser supports DeviceOrientation\");\n\t// \twindow.addEventListener(\"deviceorientation\", deviceOrientationListener, false);\n\t// \tdeviceControls = new THREE.DeviceOrientationControls( camera, renderer.domElement );\n\t// } else {\n\t// \tconsole.log(\"Sorry, your browser doesn't support Device Orientation\");\n\t// }\n\n\t\n\tclock = new THREE.Clock();\n\n\t// postprocessing\n\tcomposer = new THREE.EffectComposer( renderer );\n\trenderPass = new THREE.RenderPass( scene, camera );\n\tcomposer.addPass( renderPass );\n\toutlinePass = new THREE.OutlinePass( new THREE.Vector2(window.innerWidth, window.innerHeight), scene, camera);\n\n\toutlinePass.edgeStrength = 0.5;\n\toutlinePass.edgeGlow = 5.0;\n\toutlinePass.edgeThickness = 1.0;\n\toutlinePass.pulsePeriod = 0.5;\n\toutlinePass.visibleEdgeColor = {r: 255, g: 255, b: 255};\n\n\tcomposer.addPass( outlinePass );\n\t// @todo: prob dont need this texture but SHRUG\n\tvar onLoad = function(texture) {\n\t\toutlinePass.patternTexture = texture;\n\t\ttexture.wrapS = THREE.RepeatWrapping;\n\t\ttexture.wrapT = THREE.RepeatWrapping;\n\t};\n\tvar lod = new THREE.TextureLoader();\n\tlod.load(\n\t\t// resource URL\n\t\t'textures/tri_pattern.jpg',\n\t\t// Function when resource is loaded\n\t\tonLoad\n\t);\n\n\teffectFXAA = new THREE.ShaderPass(THREE.FXAAShader);\n\teffectFXAA.uniforms['resolution'].value.set(1 / window.innerWidth, 1 / window.innerHeight );\n\teffectFXAA.renderToScreen = true;\n\tcomposer.addPass( effectFXAA );\n\n\tcontainer.appendChild( renderer.domElement );\n\t// container.addEventListener(\"mousemove\", getPosition, false);\n\n\n\t// @todo: event aliasing\n\t// document.addEventListener(touchDevice ? 'touchstart' : 'mousedown', onDocumentMouseDown, false );\n\t// document.addEventListener(touchDevice ? 'touchmove' : 'mousemove', onDocumentMouseMove, false );\n\t// document.addEventListener(touchDevice ? 'touchend' : 'mouseup', onDocumentMouseUp, false );\n\n\tdocument.addEventListener('mousedown', onDocumentMouseDown, false );\n\tdocument.addEventListener('mousemove', onDocumentMouseMove, false );\n\tdocument.addEventListener('mouseup', onDocumentMouseUp, false );\n\n\tdocument.addEventListener( 'touchstart', onDocumentTouchStart, false );\n\tdocument.addEventListener( 'touchmove', onDocumentTouchMove, false );\n\t// document.addEventListener( 'touchend', onDocumentTouchEnd, false );\n\n\t// document.addEventListener( 'wheel', onDocumentMouseWheel, false );\n\twindow.addEventListener( 'resize', onWindowResize, false );\n\t\n\t// initRain();\n\t// buildSmoke();\n\torientCamera();\n\t\n\tdocument.body.appendChild( renderer.domElement );\n\n}\n\nfunction getUrlParams() {\n\tvar urlParams,\n\t\tmatch,\n\t    pl     = /\\+/g,  // Regex for replacing addition symbol with a space\n\t    search = /([^&=]+)=?([^&]*)/g,\n\t    decode = function (s) { return decodeURIComponent(s.replace(pl, \" \")); },\n\t    query  = window.location.search.substring(1);\n\n\turlParams = {};\n\twhile (match = search.exec(query))\n\t   urlParams[decode(match[1])] = decode(match[2]);\n\treturn urlParams;\n}\n\nfunction orientCamera() {\n\tvar urlParams = getUrlParams();\n\tif(urlParams.id) {\n\t\tlet id = parseInt(urlParams.id)\n\t\tlet hotspot = hotspotObjects.filter( hotspot => id === hotspot.id );\n\t\tif(hotspot) {\n\t\t\thotspot = hotspot[0]\n\t\t\tinitialOrientation = hotspot.lon;\n\t\t\tcurrentHotspot = hotspot\n\t\t\tmodal.show(hotspot);\n\t\t}\n\t}\n}\n\nlet buttonClicks = {\n\t// 'ig-header'() {\n\t// \tconsole.log('igHeader');\n\t// },\n\t// fb() {\n\t// \t// modal.share('fb');\n\t// }\n}\nfunction handleButtonClick(key) {\n\tif(key in buttonClicks) buttonClicks[key]();\n}\n\nfunction buildHotspots() {\n\tloader = new THREE.JSONLoader();\n\tloader.load('js/ac-logo-simple.js', function(geometry) {\n\t// loader.load('js/ac-badge-big.js', function(geometry) {\n\t// loader.load('js/ac-badge.js', function(geometry) {\n\t// loader.load('js/ac-logo.js', function(geometry) {\n\t\thotspots = hotspotObjects.map( (hotspotObject, index) => {\n\t\t\tgeometry.center();\n\n\t\t\t// previous ac-logo.js scale\n\t\t\t// let scale = 10;\n\n\t\t\t// js/ac-badge-big.js\n\t\t\t// let scale = 45;\n\n\t\t\tlet scale = 27;\n\n\t\t\t// let newMat = new THREE.MeshPhongMaterial( { \n\t\t\t// \tcolor: 0x996633, \n\t\t\t// \tspecular: 0x050505,\n\t\t\t// \tshininess: 100\n\t\t\t// } ) \n\n\t\t\tlet oldMat = new THREE.MeshBasicMaterial( { color: '#cccccc', opacity: 1 } )\n\n\t\t\tlet hotspot = new THREE.Mesh(geometry, oldMat);\n\t\t\thotspot.name = `hotspot-${index}`;\n\t\t\tvar box = new THREE.Box3().setFromObject(hotspot);\n\t\t\thotspot.scale.x = hotspot.scale.y = hotspot.scale.z = scale\n\t\t\thotspot.rotation.x = .5*Math.PI\n\t\t\thotspot.hotspot = hotspotObject;\n\n\t\t\tlet hitboxGeo = new THREE.BoxBufferGeometry( box.getSize().x * scale * 1.2, box.getSize().x * scale * 1.2 , box.getSize().x * scale * 1.2 );\n\t\t\tlet hitboxMat = new THREE.MeshBasicMaterial({ visible: false });\n\t\t\t// {wireframe: true}\n\t\t\t// // hitboxMat.visible = false\n\t\t\tlet hitboxMesh = new THREE.Mesh( hitboxGeo, hitboxMat );\n\t\t\thitboxMesh.name = `hitbox-${index}`;\n\n\t\t\tlet hotspotLocation = hotspotObject.position;\n\n\t\t\tvar group = new THREE.Group();\n\t\t\tgroup.name = `group-${index}`\n\t\t\tgroup.position.set(hotspotLocation[0], hotspotLocation[1], hotspotLocation[2]);\n\t\t\tscene.add(group);\n\t\t\tgroup.add(hotspot);\n\t\t\tgroup.add(hitboxMesh);\n\n\t\t\treturn group;\n\n\t\t});\n\t});\n}\n\n// function buildSmoke() {\n// \t// Smoke Light\n// \tlet light = new THREE.DirectionalLight(0xffffff, 1.5);\n// \tlight.position.set(-1, 0, 1);\n// \tscene.add(light);\n// \t\n// \tlet directionalLight = new THREE.DirectionalLight(0xffffff);\n// \tdirectionalLight.position.set(1, 1, 1).normalize();\n// \tscene.add(directionalLight);\n//   \n// \tlet smokeTexture = THREE.ImageUtils.loadTexture('https://s3-us-west-2.amazonaws.com/s.cdpn.io/95637/Smoke-Element.png');\n// \tlet smokeMaterial = new THREE.MeshLambertMaterial({\n// \t\tcolor: 0xffffff, \n// \t\tmap: smokeTexture, \n// \t\ttransparent: true\n// \t});\n// \tlet smokeGeo = new THREE.PlaneGeometry(500, 500);\n// \t \n// \tfor (let p = 0; p < 150; p++) {\n// \t\tlet particle = new THREE.Mesh(smokeGeo,smokeMaterial);\n// \t\tparticle.position.set(Math.random()*500-250,Math.random()*500-250,Math.random()*1000-100);\n// \t\tparticle.rotation.z = Math.random() * 360;\n// \t\tscene.add(particle);\n// \t\tsmokeParticles.push(particle);\n// \t}\n// }\n\n\n// function evolveSmoke() {\n// \tlet sp = smokeParticles.length;\n// \twhile(sp--) {\n// \t\tsmokeParticles[sp].rotation.z += (delta * 0.2);\n// \t}\n// }\n\n// function initRain() {\n// \trainGeometry = new THREE.Geometry();\n// \n// \tlet sprite1 = THREE.ImageUtils.loadTexture( \"textures/rain1.png\" ),\n// \tsprite2 = THREE.ImageUtils.loadTexture( \"textures/rain2.png\" ),\n// \tsprite3 = THREE.ImageUtils.loadTexture( \"textures/rain3.png\" ),\n// \tsprite4 = THREE.ImageUtils.loadTexture( \"textures/rain4.png\" ),\n// \tsprite5 = THREE.ImageUtils.loadTexture( \"textures/rain5.png\" );\n// \n// \tfor (let i = 0; i < rainDensity; i++ ) {\n// \t\tlet vertex = new THREE.Vector3();\n// \t\tvertex.x = Math.random() * 2000 - 1000;\n// \t\tvertex.y = Math.random() * 4000 + 500;\n// \t\tvertex.z = Math.random() * 2000 - 1000;\n// \n// \t\trainGeometry.vertices.push( vertex );\n// \t}\n// \n// \tparameters = [ [ [1.0, 0.2, 0.5], \tsprite2, 20 ],\n// \t\t\t\t   [ [0.95, 0.1, 0.5], \tsprite3, 15 ],\n// \t\t\t\t   [ [0.90, 0.05, 0.5], sprite1, 10 ],\n// \t\t\t\t   [ [0.85, 0, 0.5], \tsprite5, 8 ],\n// \t\t\t\t   [ [0.80, 0, 0.5], \tsprite4, 5 ],\n// \t\t\t\t   ];\n// \n// \tfor (let i = 0; i < parameters.length; i++ ) {\n// \n// \t\tcolor  = parameters[i][0];\n// \t\tsprite = parameters[i][1];\n// \t\tsize   = parameters[i][2];\n// \n// \t\tmaterials[i] = new THREE.PointCloudMaterial({ \n// \t\t\tsize: size, \n// \t\t\tmap: sprite, \n// \t\t\tblending: THREE.AdditiveBlending, \n// \t\t\tdepthTest: false, \n// \t\t\ttransparent : true \n// \t\t});\n// \t\tmaterials[i].color.setHSL( color[0], color[1], color[2] );\n// \n// \t\tparticles = new THREE.PointCloud( rainGeometry, materials[i] );\n// \n// \t\tparticles.rotation.z = Math.random() * 0.20 + 0.10;\n// \n// \t\tscene.add( particles );\n// \t}\n// }\n\n// function animateRain() {\n// \t// console.log(\"I'M ANIMATING THINGS\");\n// \tlet time = Date.now() * 0.00005;\n// \n// \tfor (let i = 0; i < scene.children.length; i++ ) {\n// \n// \t\tlet object = scene.children[i];\n// \t\t\n// \t\tif ( object instanceof THREE.PointCloud ) {\n// \t\t\t// Not getting into the log here\n// \t\t\tconsole.log(\"I'M ANIMATING THINGS\");\n// \t\t\tif (i == 0) {\n// \t\t\t\tobject.translateY(-10);\n// \t\t\t}\n// \n// \t\t\tif (i > 0) {\n// \t\t\t\tif (layer)\n// \t\t\t\t\tobject.translateY(-10);\n// \t\t\t\telse\n// \t\t\t\t\tif(scene.children[i-1].position.y < ((window.innerHeight * -1) / 2 - 1000))\n// \t\t\t\t\t\tobject.translateY(-10);\n// \t\t\t}\n// \n// \t\t\tif ((object.position.y < window.innerHeight * -1 * 5)) {\n// \t\t\t\t\tobject.position.y = 500;\n// \t\t\t\t\tobject.position.x = 0;\n// \t\t\t\t\tif (i == 0) layer = true;\n// \t\t\t}\n// \t\t}\n// \t}\n// \n// \tfor (let i = 0; i < materials.length; i++ ) {\n// \n// \t\tcolor = parameters[i][0];\n// \n// \t\th = ( 360 * ( color[0] + time ) % 360 ) / 360;\n// \t\tmaterials[i].color.setHSL( h, color[1], color[2] );\n// \n// \t}\n// }\n\nfunction onWindowResize() {\n\tvar width = window.innerWidth || 1;\n\tvar height = window.innerHeight || 1;\n\tvar devicePixelRatio = window.devicePixelRatio || 1;\n\tcamera.aspect = width / height;\n\tcamera.updateProjectionMatrix();\n\trenderer.setSize( width, height );\n\tcomposer.setSize( width, height );\n\teffectFXAA.uniforms['resolution'].value.set(1 / window.innerWidth, 1 / window.innerHeight );\n}\n\n// function onDocumentTouchEnd() {\n// \tconsole.log('---- onDocumentTouchEnd ----');\n// }\n\nfunction onDocumentTouchStart(event) {\n\tconsole.log('---- onDocumentTouchStart ----', event);\n\tif(event.touches && event.touches.length === 1) {\n\t\tlet touch = event.touches[0];\n\t\ttouchStartX = touch.pageX;\n\t\tcheckRaycasterCollisions(touch.pageX, touch.pageY);\n\t\tif(selectedObjects.length) {\n\t\t\tonDocumentMouseDown(event, true);\n\t\t\tfreeze = true;\n\t\t}\n\t} else {\n\t\tevent.preventDefault();\n\t}\n\t// console.log('--- INDEX TOUCH START ---');\n\t// event.preventDefault();\n\t// event.clientX = event.touches[0].clientX;\n\t// event.clientY = event.touches[0].clientY;\n}\n\nfunction onDocumentTouchMove(event) {\n\tconsole.log('---- onDocumentTouchMove ----')\n\tif(event.touches && event.touches.length) {\n\t\tvar delta = touchStartX - event.touches[0].pageX;\n\t\ttouchStartX = event.touches[0].pageX;\n\t\tposition.lon += delta;\n\t}\n}\n\nfunction addSelectedObject(object) {\n\tselectedObjects = [];\n\tselectedObjects.push(object);\n}\n\nfunction checkRaycasterCollisions(x, y) {\n\n\tvar mouse3D = new THREE.Vector3( ( x / window.innerWidth ) * 2 - 1,\n\t\t\t\t\t\t\t\t\t-( y / window.innerHeight ) * 2 + 1,\n\t\t\t\t\t\t\t\t\t0.5 );\n\traycaster.setFromCamera( mouse3D, camera );\n\tlet intersects = raycaster.intersectObjects(scene.children, true);\n\tlet items = intersects.filter( intersect => intersect.object.name.match(/hitbox/) );\n\tif(items.length) {\n\t\titems.forEach((item) => {\n\t\t\tlet target = item.object.parent.children[0]\n\t\t\tif(selectedObjects.indexOf(target) === -1) {\n\t\t\t\t$('body').addClass('hot');\n\t\t\t\taddSelectedObject(target);\n\t\t\t}\n\t\t});\n\t} else {\n\t\t$('body').removeClass('hot');\n\t\tselectedObjects = [];\n\t}\n\toutlinePass.selectedObjects = selectedObjects;\n}\n\n// function renderFeatureMesh() {\n// \tvar feature = $('.feature');\n\n// \tif(feature.find('canvas').length) return;\n// \tvar scene = new THREE.Scene();\n// \tvar camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);\n\n// \tvar renderer = new THREE.WebGLRenderer();\n// \trenderer.setSize(feature.width(), feature.height());\n// \tfeature.append(renderer.domElement);\n\n// \tvar geometry = new THREE.CubeGeometry(5, 5, 5);\n// \tvar material = new THREE.MeshLambertMaterial({\n// \t\tcolor: 0x00fff0\n// \t});\n// \tvar cube = new THREE.Mesh(geometry, material);\n// \tscene.add(cube);\n\n// \tcamera.position.z = 12;\n\n// \tvar pointLight = new THREE.PointLight(0xFFFFFF);\n\n// \tpointLight.position.x = 10;\n// \tpointLight.position.y = 50;\n// \tpointLight.position.z = 130;\n\n// \tscene.add(pointLight);\n\n// \tvar reqAnimFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.msRequestAnimationFrame;\n\n// \tvar render = function() {\n// \t\treqAnimFrame(render);\n\n// \t\tvar delta = Math.random() * (0.06 - 0.02) + 0.02;\n\n// \t\tcube.rotation.x += delta;\n// \t\tcube.rotation.y += delta;\n// \t\tcube.rotation.z -= delta;\n\n// \t\trenderer.render(scene, camera);\n// \t};\n\n// \trender();\n// }\n\n\nfunction makeUrlParams(id, subid) {\n\tlet str = '';\n\tif(id !== undefined || id !== null) {\n\t\tstr += `?id=${id}`;\n\t}\n\tif(!subid) subid = 0;\n\tstr += `&subid=${subid}`;\n\tconsole.log('makeUrlParams', id, subid, str);\n\treturn str;\n}\n\nfunction tweenArc(start, end) {\n\tlet relativity;\n\tlet delta = start-end;\n\tlet absDelta = Math.abs(delta);\n\tif(start < end) {\n\t\trelativity = absDelta < 180 ? '+=' : '-=';\n\t} else {\n\t\trelativity = absDelta < 180 ? '-=' : '+=';\n\t}\n\treturn {value: 360-absDelta < absDelta ? 360-absDelta : absDelta, relativity: relativity};\n}\n\nfunction onDocumentMouseDown(event, isTouch) {\n\tconsole.log('---- onDocumentMouseDown ----', freeze)\n\tif(freeze) {\n\t\tconsole.log('action frozen');\n\t\treturn;\n\t}\n\tisUserInteracting = true;\n\tif(selectedObjects.length && !showingModal) {\n\t\tlet so = selectedObjects[0].hotspot;\n\t\tlet currentLon = position.lon\n\t\tlet hotspotLon = selectedObjects[0].hotspot.lon\n\t\tlet data = tweenArc(currentLon, hotspotLon);\n\n\t\tlet maxDelta = 40;\n\t\tlet delta = data.value;\n\t\tlet maxDura = 550;\n\t\tlet duration = ((delta/maxDelta)*maxDura)/1000;\n\n\t\tif(isTouch) {\n\t\t\tposition.lon = position.lon%360;\n\t\t\tcurPosX = position.lon;\n\t\t\tcurrentHotspot = so\n\t\t\tmodal.show(so, 0);\n\t\t} else {\n\t\t\tTweenMax.to(position, duration, {lon: `${data.relativity}${data.value}`, onComplete: function() {\n\t\t\t\tposition.lon = position.lon%360;\n\t\t\t\tcurPosX = position.lon;\n\t\t\t\tcurrentHotspot = so\n\t\t\t\tmodal.show(so, 0);\n\t\t\t}});\n\t\t}\n\t}\n}\n\nfunction rotateHotspots() {\n\thotspots.forEach( hotspot => hotspot.children[0].rotation.z += rotateSpeed * 0.5 );\n}\n\nfunction onDocumentMouseMove(event) {\n\tconsole.log('---- onDocumentMouseMove ----', freeze);\n\tif(freeze) {\n\t\tconsole.log('action frozen');\n\t\treturn;\n\t}\n\tcheckRaycasterCollisions(event.clientX, event.clientY);\n\tif(isUserInteracting && !showingModal) {\n\t\tlet movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;\n\t\tlet movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;\n\t\tcurPosX += movementX;\n\t\tif(curPosX < 0) {\n\t\t\tcurPosX = 360 + curPosX;\n\t\t}\n\t\tif(curPosX > 360) {\n\t\t\tcurPosX = 0;\n\t\t}\n\t\tposition.lon = curPosX;\n\t}\n}\n\nfunction onDocumentMouseUp( event ) {\n\tisUserInteracting = false;\n}\n\n// Zoom in & out | Need to limit this to the starting point and a endind point\nfunction onDocumentMouseWheel( event ) {\n\tif (camera.fov > 75) {\n\t\tcamera.fov = 75\n\t} else {\n\t\tcamera.fov += event.deltaY * 0.02;\n\t\tcamera.updateProjectionMatrix();\n\t}\n\t// camera.fov += event.deltaY * 0.02;\n\t// camera.updateProjectionMatrix();\n}\n\nfunction animate() {\n\trequestAnimationFrame( animate );\n\tupdate();\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n}\n\nfunction update() {\n\t// if ( isUserInteracting === false ) {\n\t// \t// lon += 0.1;\n\t// }\n\t// console.log('initialOrientation', lon, initialOrientation)\n\t// console.log('update', lon)\n\tif(initialOrientation) {\n\t\tposition.lon = initialOrientation;\n\t\tinitialOrientation = null;\n\t}\n\n\tlat = Math.max( - 85, Math.min( 85, lat ) );\n\tphi = THREE.Math.degToRad( 90 - lat );\n\ttheta = THREE.Math.degToRad( position.lon );\n\n\tcamera.target.x = 1 * Math.sin( phi ) * Math.cos( theta );\n\t// camera.target.y = 1 * Math.cos( phi );\n\tcamera.target.z = 1 * Math.sin( phi ) * Math.sin( theta );\n\tcamera.lookAt( camera.target );\n\n\t/*\n\t// distortion\n\tcamera.position.copy( camera.target ).negate();\n\t*/\n\t// let delta = clock.getDelta(), speed = delta * CAMERAMOVESPEED;\n\t// controls.update(delta);\n\t// spotLight.target = marker;\n\t// controls.update()\n\t\n\t// spotLightHelper.update()\n\tstats.update()\n\tdelta = clock.getDelta();\n\n\t// evolveSmoke();\n\t// animateRain();\n\t// rotateHotspot();\n\trotateHotspots();\n\n\t// checkRaycasterCollisions();\n\n\t// rainEngine.update(0.01 * 0.5)\n\ttheta += 0.1;\n\t// let radius = 600;\n\t// camera.position.x = radius * Math.sin( THREE.Math.degToRad( theta ) );\n\t// camera.position.y = radius * Math.sin( THREE.Math.degToRad( theta ) );\n\t// camera.position.z = radius * Math.cos( THREE.Math.degToRad( theta ) );\n\t// camera.lookAt( scene.position );\n\t// if (window.innerWidth < 800) {\n\t// \tdeviceControls.update();\n\t// }\n\t\n\t// if (window.innerWidth < 768) {\n\t\t// deviceControls.update()\n\t\t// camera.lookAt(deviceControls.gamma)\n\t\t// console.log(deviceControls);\n\t\t\n\t\t// sconsole.log(\"DEVICE CONTROLS\", deviceControls);\n\t\t// deviceControls.alpha = 0\n\t\t// deviceControls.beta = 180\n\t\t// deviceControls.gamma = 90\n\t\t// deviceControls.updateAlphaOffsetAngle(0);\n\t// }\n\t\n\t// if (window.DeviceOrientationEvent) {\n\t// \twindow.addEventListener('deviceorientation', function(event) {\n\t// \t\tlet alpha = event.alpha;\n\t// \t\tlet beta = event.beta;\n\t// \t\tlet gamma = event.gamma;\n\t// \t\t// console.log(\"We on Mobile\")\n\t// \t\t// console.log(\"GAMMA\" gamma);\n\t// \t\tdeviceControls.update();\n\t// \t\t// Do something\n\t// \t}, false);\n\t// }\n\t\n\tdeviceControls.update()\n\t\n\t// deviceControls.connect();\n\trenderer.render( scene, camera );\n\t// renderer.render( scene, camera );\n\tcamera.updateProjectionMatrix();\n\tcomposer.render();\n\t// renderer.autoClear = true;\n\t// renderer.setClearColor( 0xfff0f0 );\n\t// renderer.setClearAlpha( 0.0 );\n}\n\nTweenLite.ticker.addEventListener(\"tick\", render);\n\nfunction initStats() {\n\t// stats.setMode(0); // 0: fps, 1: ms\n\t// Align top-left\n\tstats = new Stats();\n\tstats.domElement.style.position = 'absolute';\n\t// stats.domElement.style.bottom = '0px';\n\tstats.domElement.style.left = '0px';\n\tstats.domElement.style.top = '0px';\n\tstats.domElement.style.zIndex = 100;\n\tcontainer.appendChild(stats.domElement);\n\treturn stats;\n}\n\n\n// function deviceOrientationListener(event) {\n// \tlet deg2rad = Math.PI / 180;\n// \tcamera.rotation.set(\n//         !event.beta * deg2rad,\n//         !event.gamma ? 0 : event.gamma * deg2rad,\n//         !event.alpha ? 0 : event.alpha * deg2rad\n//     );\n// \t\n// \tconsole.log(event.beta * deg2rad)\n// \tconsole.log(event.gamma * deg2rad)\n// \tconsole.log(event.alpha * deg2rad)\n// \t\n//         // console.log(\"Do Stuff With Device\", event);\n//         // ctx.clearRect(0, 0, c.width, c.height);\n//         // ctx.fillStyle = \"#FF7777\";\n//         // ctx.font = \"14px Verdana\";\n//         // ctx.fillText(\"Alpha: \" + Math.Round(event.alpha), 10, 20);\n//         // ctx.beginPath();\n//         // ctx.moveTo(180, 75);\n//         // ctx.lineTo(210, 75);\n//         // ctx.arc(180, 75, 60, 0, event.alpha * Math.PI / 180);\n//         // ctx.fill();\n// \t\t// \n//         // ctx.fillStyle = \"#FF6600\";\n//         // ctx.fillText(\"Beta: \" + Math.round(event.beta), 10, 140);\n//         // ctx.beginPath();\n//         // ctx.fillRect(180, 150, event.beta, 90);\n// \t\t// \n//         // ctx.fillStyle = \"#FF0000\";\n//         // ctx.fillText(\"Gamma: \" + Math.round(event.gamma), 10, 270);\n//         // ctx.beginPath();\n//         // ctx.fillRect(90, 340, 180, event.gamma);\n// }\n\n//DeviceOrientationController event handling\nfunction setupControllerEventHandlers( controls ) {\n\t\n\tvar controllerEl = document.querySelector( '#controllername' );\n\tvar controllerDefaultText = controllerEl.textContent;\n\tvar controllerSelectorEl = document.querySelector( '#controllertype' );\n\tvar compassCalibrationPopupEl = document.querySelector( '#calibrate-compass-popup' );\n\t\n\t// Listen for manual interaction (zoom OR rotate)\t\n\tcontrols.addEventListener( 'userinteractionstart', function () {\n\t\trenderer.domElement.style.cursor = 'move';\n\t\tcontrollerSelectorEl.style.display = 'none';\n\t});\n\t\n\tcontrols.addEventListener( 'userinteractionend', function () {\n\t\trenderer.domElement.style.cursor = 'default';\n\t\tcontrollerSelectorEl.style.display = 'inline-block';\n\t});\n\t\n\t// Listen for manual rotate interaction\t\n\tcontrols.addEventListener( 'rotatestart', function () {\n\t\tcontrollerEl.innerText = 'Manual Rotate';\n\t});\n\t\n\tcontrols.addEventListener( 'rotateend', function () {\n\t\tcontrollerEl.innerText = controllerDefaultText;\n\t});\n\t\n\t// Listen for manual zoom interaction\n\tcontrols.addEventListener( 'zoomstart', function () {\n\t\tcontrollerEl.innerText = 'Manual Zoom';\n\t});\n\t\n\tcontrols.addEventListener( 'zoomend', function () {\n\t\tcontrollerEl.innerText = controllerDefaultText;\n\t});\n\t\n\t// Allow advanced switching between 'Quaternions' and 'Rotation Matrix' calculations\n\tcontrollerSelectorEl.addEventListener( 'click', function ( event ) {\n\t\tevent.preventDefault();\n\t\t\n\t\tif ( controls.useQuaternions === true ) {\n\t\t\tcontrollerSelectorEl.textContent = 'Rotation Matrix';\n\t\t\tcontrols.useQuaternions = false;\n\t\t} else {\n\t\t\tcontrollerSelectorEl.textContent = 'Quaternions';\n\t\t\tcontrols.useQuaternions = true;\n\t\t}\n\t}, false);\n}"]}