{"version":3,"sources":["index.js"],"names":["siteConfig","siteURL","shareText","siteTweet","assetShare","assetTweet","position","lon","curPosX","fovMin","fovMax","onPointerDownPointerX","onPointerDownLon","blocked","touchStartX","mouseStartX","camera","container","color","controls","clock","delta","deviceControls","h","hotspot","info","logoGeo","logoMaterial","logoMesh","logoTexture","marker","mesh","materials","mouse","mousePos","objects","parameters","particles","particleMaterial","rainDensity","rainGeometry","raycaster","renderer","scene","size","smokeParticles","spotLight","spotLightHelper","sprite","stats","layer","hsParticles","rotateSpeed","hotspots","hotspotObjects","id","slides","title","image","key","description","onMouseDownMouseX","onMouseDownMouseY","onMouseDownLon","lat","onMouseDownLat","phi","theta","document","getElementById","containerWidth","clientWidth","containerHeight","clientHeight","selectedObjects","loader","renderPass","outlinePass","composer","effectFXAA","showingModal","initialOrientation","isUserInteracting","freeze","projector","THREE","Projector","mouseVector","Vector3","currentHotspot","touchDevice","window","DocumentTouch","showLoader","playAudio","audio","progressBar","$","numAnim","CountUp","percent","suffix","filesLoaded","totalFiles","loadTick","update","css","button","TweenMax","to","autoAlpha","on","delay","onComplete","volume","play","preloadAudio","url","Audio","addEventListener","console","log","error","src","load","preloadImages","map","hotspotObject","reduce","prev","current","concat","length","forEach","slide","Image","onload","DefaultLoadingManager","onProgress","item","loaded","total","hide","setupButtons","each","$el","clone","find","attr","append","after","buttons","animate","event","currentTarget","set","Modal","modal","content","facebookShare","twitterShare","nextButton","prevButton","addClass","removeClass","bindEvents","prototype","next","shareFacebook","shareTwitter","duration","offset","setModalValues","href","makeUrlParams","picture","FB","ui","method","replace","response","params","encodeURIComponent","text","hashtags","open","i","bind","fov","off","show","subid","fadeIn","activeSlide","setTimeout","top","keyCode","ready","index","el","ProgressBar","Path","get","easing","handleButtonClick","offLine","parents","pause","init","width","innerWidth","height","innerHeight","devicePixelRatio","WebGLRenderer","antialias","physicallyCorrectLights","gammaInput","gammaOutput","shadowMap","enabled","renderReverseSided","toneMapping","ReinhardToneMapping","toneMappingExposure","setClearColor","setPixelRatio","setSize","PerspectiveCamera","target","Scene","geometry","SphereGeometry","scale","material","MeshBasicMaterial","TextureLoader","fog","Mesh","name","add","Raycaster","Vector2","hemiLight","HemisphereLight","buildHotspots","DeviceOrientationController","domElement","connect","setupControllerEventHandlers","Clock","EffectComposer","RenderPass","addPass","OutlinePass","edgeStrength","edgeGlow","edgeThickness","pulsePeriod","visibleEdgeColor","r","g","b","onLoad","texture","patternTexture","wrapS","RepeatWrapping","wrapT","lod","ShaderPass","FXAAShader","uniforms","value","renderToScreen","appendChild","onDocumentMouseDown","onDocumentMouseMove","onDocumentMouseUp","onDocumentTouchStart","onDocumentTouchMove","onWindowResize","orientCamera","body","getUrlParams","urlParams","match","pl","search","decode","s","decodeURIComponent","query","location","substring","exec","parseInt","filter","buttonClicks","fb","JSONLoader","center","newMat","MeshPhongMaterial","specular","shininess","oldMat","opacity","box","Box3","setFromObject","x","y","z","rotation","Math","PI","hitboxGeo","BoxBufferGeometry","getSize","hitboxMat","visible","hitboxMesh","hotspotLocation","group","Group","aspect","updateProjectionMatrix","touches","touch","pageX","checkRaycasterCollisions","pageY","preventDefault","addSelectedObject","object","push","mouse3D","setFromCamera","intersects","intersectObjects","children","items","intersect","parent","indexOf","str","undefined","tweenArc","start","end","relativity","absDelta","abs","isTouch","clientX","so","currentLon","hotspotLon","data","maxDelta","maxDura","rotateHotspots","clientY","deltaX","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","onDocumentMouseWheel","deltaY","requestAnimationFrame","max","min","degToRad","sin","cos","lookAt","getDelta","render","TweenLite","ticker","controllerEl","querySelector","controllerDefaultText","textContent","controllerSelectorEl","compassCalibrationPopupEl","style","cursor","display","innerText","useQuaternions"],"mappings":"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MgP,KAAV,EAAZ;AACAD,SAAMrF,IAAN,cAAsBzC,KAAtB;AACA8H,SAAM9T,QAAN,CAAeqJ,GAAf,CAAmBwK,gBAAgB,CAAhB,CAAnB,EAAuCA,gBAAgB,CAAhB,CAAvC,EAA2DA,gBAAgB,CAAhB,CAA3D;AACAxR,SAAMqM,GAAN,CAAUoF,KAAV;AACAA,SAAMpF,GAAN,CAAUxN,OAAV;AACA4S,SAAMpF,GAAN,CAAUkF,UAAV;;AAEA,UAAOE,KAAP;AAEA,GAjDU,CAAX;AAkDA,EAvDD;AAwDA;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS3C,cAAT,GAA0B;AACzB,KAAIxE,QAAQtH,OAAOuH,UAAP,IAAqB,CAAjC;AACA,KAAIC,SAASxH,OAAOyH,WAAP,IAAsB,CAAnC;AACA,KAAIC,mBAAmB1H,OAAO0H,gBAAP,IAA2B,CAAlD;AACArM,QAAOsT,MAAP,GAAgBrH,QAAQE,MAAxB;AACAnM,QAAOuT,sBAAP;AACA7R,UAASyL,OAAT,CAAkBlB,KAAlB,EAAyBE,MAAzB;AACArI,UAASqJ,OAAT,CAAkBlB,KAAlB,EAAyBE,MAAzB;AACApI,YAAWiM,QAAX,CAAoB,YAApB,EAAkCC,KAAlC,CAAwCtH,GAAxC,CAA4C,IAAIhE,OAAOuH,UAAvD,EAAmE,IAAIvH,OAAOyH,WAA9E;AACA;;AAED;AACA;AACA;;AAEA,SAASmE,oBAAT,CAA8B9H,KAA9B,EAAqC;AACpC,KAAGA,MAAM+K,OAAN,IAAiB/K,MAAM+K,OAAN,CAAcpM,MAAd,KAAyB,CAA7C,EAAgD;AAC/C,MAAIqM,QAAQhL,MAAM+K,OAAN,CAAc,CAAd,CAAZ;AACA1T,gBAAc2T,MAAMC,KAApB;AACAC,2BAAyBF,MAAMC,KAA/B,EAAsCD,MAAMG,KAA5C;AACA,MAAGlQ,gBAAgB0D,MAAnB,EAA2B;AAC1BgJ,uBAAoB3H,KAApB,EAA2B,IAA3B;AACAtE,YAAS,IAAT;AACA;AACD,EARD,MAQO;AACNsE,QAAMoL,cAAN;AACA;AACD;;AAED,SAASrD,mBAAT,CAA6B/H,KAA7B,EAAoC;AACnC,KAAGA,MAAM+K,OAAN,IAAiB/K,MAAM+K,OAAN,CAAcpM,MAAlC,EAA0C;AACzC,MAAI/G,QAAQP,cAAc2I,MAAM+K,OAAN,CAAc,CAAd,EAAiBE,KAA3C;AACA5T,gBAAc2I,MAAM+K,OAAN,CAAc,CAAd,EAAiBE,KAA/B;AACApU,WAASC,GAAT,IAAgBc,KAAhB;AACA;AACD;;AAED,SAASyT,iBAAT,CAA2BC,MAA3B,EAAmC;AAClCrQ,mBAAkB,EAAlB;AACAA,iBAAgBsQ,IAAhB,CAAqBD,MAArB;AACA;;AAED,SAASJ,wBAAT,CAAkCpB,CAAlC,EAAqCC,CAArC,EAAwC;;AAEvC,KAAIyB,UAAU,IAAI5P,MAAMG,OAAV,CAAqB+N,IAAI5N,OAAOuH,UAAb,GAA4B,CAA5B,GAAgC,CAAnD,EACN,EAAGsG,IAAI7N,OAAOyH,WAAd,IAA8B,CAA9B,GAAkC,CAD5B,EAEN,GAFM,CAAd;AAGA3K,WAAUyS,aAAV,CAAyBD,OAAzB,EAAkCjU,MAAlC;AACA,KAAImU,aAAa1S,UAAU2S,gBAAV,CAA2BzS,MAAM0S,QAAjC,EAA2C,IAA3C,CAAjB;AACA,KAAIC,QAAQH,WAAW1C,MAAX,CAAmB;AAAA,SAAa8C,UAAUR,MAAV,CAAiBhG,IAAjB,CAAsB+C,KAAtB,CAA4B,QAA5B,CAAb;AAAA,EAAnB,CAAZ;AACA,KAAGwD,MAAMlN,MAAT,EAAiB;AAChBkN,QAAMjN,OAAN,CAAc,UAACM,IAAD,EAAU;AACvB,OAAI0F,SAAS1F,KAAKoM,MAAL,CAAYS,MAAZ,CAAmBH,QAAnB,CAA4B,CAA5B,CAAb;AACA,OAAG3Q,gBAAgB+Q,OAAhB,CAAwBpH,MAAxB,MAAoC,CAAC,CAAxC,EAA2C;AAC1CpI,MAAE,MAAF,EAAUkE,QAAV,CAAmB,KAAnB;AACA2K,sBAAkBzG,MAAlB;AACA;AACD,GAND;AAOA,EARD,MAQO;AACNpI,IAAE,MAAF,EAAUmE,WAAV,CAAsB,KAAtB;AACA1F,oBAAkB,EAAlB;AACA;AACDG,aAAYH,eAAZ,GAA8BA,eAA9B;AACA;;AAED;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;;AAGA,SAASoG,aAAT,CAAuBvH,EAAvB,EAA2BwI,KAA3B,EAAkC;AACjC,KAAI2J,MAAM,EAAV;AACA,KAAGnS,OAAOoS,SAAP,IAAoBpS,OAAO,IAA9B,EAAoC;AACnCmS,kBAAcnS,EAAd;AACA;AACD,KAAG,CAACwI,KAAJ,EAAWA,QAAQ,CAAR;AACX2J,oBAAiB3J,KAAjB;AACA,QAAO2J,GAAP;AACA;;AAED,SAASE,QAAT,CAAkBC,KAAlB,EAAyBC,GAAzB,EAA8B;AAC7B,KAAIC,mBAAJ;AACA,KAAI1U,QAAQwU,QAAMC,GAAlB;AACA,KAAIE,WAAWrC,KAAKsC,GAAL,CAAS5U,KAAT,CAAf;AACA,KAAGwU,QAAQC,GAAX,EAAgB;AACfC,eAAaC,WAAW,GAAX,GAAiB,IAAjB,GAAwB,IAArC;AACA,EAFD,MAEO;AACND,eAAaC,WAAW,GAAX,GAAiB,IAAjB,GAAwB,IAArC;AACA;AACD,QAAO,EAAC/E,OAAO,MAAI+E,QAAJ,GAAeA,QAAf,GAA0B,MAAIA,QAA9B,GAAyCA,QAAjD,EAA2DD,YAAYA,UAAvE,EAAP;AACA;;AAED,SAAS3E,mBAAT,CAA6B3H,KAA7B,EAAoCyM,OAApC,EAA6C;AAC5C,KAAG/Q,MAAH,EAAW;AACXD,qBAAoB,IAApB;AACAnE,eAAc0I,MAAM0M,OAApB;AACA,KAAGzR,gBAAgB0D,MAAhB,IAA0B,CAACpD,YAA9B,EAA4C;AAAA;AAC3C,OAAIoR,KAAK1R,gBAAgB,CAAhB,EAAmBlD,OAA5B;AACA,OAAI6U,aAAa/V,SAASC,GAA1B;AACA,OAAI+V,aAAa5R,gBAAgB,CAAhB,EAAmBlD,OAAnB,CAA2BjB,GAA5C;AACA,OAAIgW,OAAOX,SAASS,UAAT,EAAqBC,UAArB,CAAX;;AAEA,OAAIE,WAAW,EAAf;AACA,OAAInV,QAAQkV,KAAKtF,KAAjB;AACA,OAAIwF,UAAU,GAAd;AACA,OAAI/L,WAAarJ,QAAMmV,QAAP,GAAiBC,OAAlB,GAA2B,IAA1C;;AAEA,OAAGP,OAAH,EAAY;AACX5V,aAASC,GAAT,GAAeD,SAASC,GAAT,GAAa,GAA5B;AACAC,cAAUF,SAASC,GAAnB;AACAkF,qBAAiB2Q,EAAjB;AACAvM,UAAMiC,IAAN,CAAWsK,EAAX,EAAe,CAAf;AACA,IALD,MAKO;AACNxP,aAASC,EAAT,CAAYvG,QAAZ,EAAsBoK,QAAtB,EAAgC,EAACnK,UAAQgW,KAAKR,UAAb,GAA0BQ,KAAKtF,KAAhC,EAAyChK,YAAY,sBAAW;AAC/F3G,eAASC,GAAT,GAAeD,SAASC,GAAT,GAAa,GAA5B;AACAC,gBAAUF,SAASC,GAAnB;AACAkF,uBAAiB2Q,EAAjB;AACAvM,YAAMiC,IAAN,CAAWsK,EAAX,EAAe,CAAf;AACA,MAL+B,EAAhC;AAMA;AAvB0C;AAwB3C;AACD;;AAED,SAASM,cAAT,GAA0B;AACzBrT,UAASgF,OAAT,CAAkB;AAAA,SAAW7G,QAAQ6T,QAAR,CAAiB,CAAjB,EAAoB3B,QAApB,CAA6BD,CAA7B,IAAkCrQ,cAAc,GAA3D;AAAA,EAAlB;AACA;;AAED,SAASiO,mBAAT,CAA6B5H,KAA7B,EAAoC;AACnC,KAAGtE,MAAH,EAAW;AACXwP,0BAAyBlL,MAAM0M,OAA/B,EAAwC1M,MAAMkN,OAA9C;AACA,KAAGzR,qBAAqB,CAACF,YAAzB,EAAuC;AACtC,MAAI4R,SAAS7V,cAAc0I,MAAM0M,OAAjC;AACApV,gBAAc0I,MAAM0M,OAApB;AACA,MAAIU,YAAY,eAAepN,KAAf,IAAwB,kBAAkBA,KAA1C,IAAmD,qBAAqBA,KAAxE,GAAgFA,MAAMoN,SAAN,IAAmBpN,MAAMqN,YAAzB,IAAyCrN,MAAMsN,eAA/C,IAAkE,CAAlJ,GAAsJH,UAAU,CAAhL;AACA,MAAII,YAAYvN,MAAMuN,SAAN,IAAmBvN,MAAMwN,YAAzB,IAAyCxN,MAAMyN,eAA/C,IAAkE,CAAlF;AACA1W,aAAWqW,SAAX;AACA,MAAGrW,UAAU,CAAb,EAAgB;AACfA,aAAU,MAAMA,OAAhB;AACA;AACD,MAAGA,UAAU,GAAb,EAAkB;AACjBA,aAAU,CAAV;AACA;AACDF,WAASC,GAAT,GAAeC,OAAf;AACA;AACD;;AAED,SAAS8Q,iBAAT,CAA4B7H,KAA5B,EAAoC;AACnCvE,qBAAoB,KAApB;AACA;AACA;;AAED;AACA,SAASiS,oBAAT,CAA+B1N,KAA/B,EAAuC;AACtC,KAAIzI,OAAO4K,GAAP,GAAa,EAAjB,EAAqB;AACpB5K,SAAO4K,GAAP,GAAa,EAAb;AACA,EAFD,MAEO;AACN5K,SAAO4K,GAAP,IAAcnC,MAAM2N,MAAN,GAAe,IAA7B;AACApW,SAAOuT,sBAAP;AACA;AACD;AACA;AACA;;AAED,SAAS/K,OAAT,GAAmB;AAClB6N,uBAAuB7N,OAAvB;AACA/C;AACA/D,UAASyL,OAAT,CAAkBxI,OAAOuH,UAAzB,EAAqCvH,OAAOyH,WAA5C;AACA;;AAED,SAAS3G,MAAT,GAAkB;AACjB;AACA;AACA;AACA;AACA;AACA,KAAGxB,kBAAH,EAAuB;AACtB3E,WAASC,GAAT,GAAe0E,kBAAf;AACAA,uBAAqB,IAArB;AACA;;AAEDjB,OAAM2P,KAAK2D,GAAL,CAAU,CAAE,EAAZ,EAAgB3D,KAAK4D,GAAL,CAAU,EAAV,EAAcvT,GAAd,CAAhB,CAAN;AACAE,OAAMmB,MAAMsO,IAAN,CAAW6D,QAAX,CAAqB,KAAKxT,GAA1B,CAAN;AACAG,SAAQkB,MAAMsO,IAAN,CAAW6D,QAAX,CAAqBlX,SAASC,GAA9B,CAAR;;AAEAS,QAAOqN,MAAP,CAAckF,CAAd,GAAkB,IAAII,KAAK8D,GAAL,CAAUvT,GAAV,CAAJ,GAAsByP,KAAK+D,GAAL,CAAUvT,KAAV,CAAxC;AACA;AACAnD,QAAOqN,MAAP,CAAcoF,CAAd,GAAkB,IAAIE,KAAK8D,GAAL,CAAUvT,GAAV,CAAJ,GAAsByP,KAAK8D,GAAL,CAAUtT,KAAV,CAAxC;AACAnD,QAAO2W,MAAP,CAAe3W,OAAOqN,MAAtB;;AAEA;;;;AAIA;AACA;AACA;AACA;;AAEA;AACA;AACAhN,SAAQD,MAAMwW,QAAN,EAAR;;AAEA;AACA;AACA;AACAlB;;AAEA;;AAEA;AACAvS,UAAS,GAAT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA7C,gBAAemF,MAAf;;AAEA;AACA/D,UAASmV,MAAT,CAAiBlV,KAAjB,EAAwB3B,MAAxB;AACA;AACAA,QAAOuT,sBAAP;AACAzP,UAAS+S,MAAT;AACA;AACA;AACA;AACA;;AAEDC,UAAUC,MAAV,CAAiBxQ,gBAAjB,CAAkC,MAAlC,EAA0CsQ,MAA1C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,SAASpI,4BAAT,CAAuCtO,QAAvC,EAAkD;;AAEjD,KAAI6W,eAAe5T,SAAS6T,aAAT,CAAwB,iBAAxB,CAAnB;AACA,KAAIC,wBAAwBF,aAAaG,WAAzC;AACA,KAAIC,uBAAuBhU,SAAS6T,aAAT,CAAwB,iBAAxB,CAA3B;AACA,KAAII,4BAA4BjU,SAAS6T,aAAT,CAAwB,0BAAxB,CAAhC;;AAEA;AACA9W,UAASoG,gBAAT,CAA2B,sBAA3B,EAAmD,YAAY;AAC9D7E,WAAS6M,UAAT,CAAoB+I,KAApB,CAA0BC,MAA1B,GAAmC,MAAnC;AACAH,uBAAqBE,KAArB,CAA2BE,OAA3B,GAAqC,MAArC;AACA,EAHD;;AAKArX,UAASoG,gBAAT,CAA2B,oBAA3B,EAAiD,YAAY;AAC5D7E,WAAS6M,UAAT,CAAoB+I,KAApB,CAA0BC,MAA1B,GAAmC,SAAnC;AACAH,uBAAqBE,KAArB,CAA2BE,OAA3B,GAAqC,cAArC;AACA,EAHD;;AAKA;AACArX,UAASoG,gBAAT,CAA2B,aAA3B,EAA0C,YAAY;AACrDyQ,eAAaS,SAAb,GAAyB,eAAzB;AACA,EAFD;;AAIAtX,UAASoG,gBAAT,CAA2B,WAA3B,EAAwC,YAAY;AACnDyQ,eAAaS,SAAb,GAAyBP,qBAAzB;AACA,EAFD;;AAIA;AACA/W,UAASoG,gBAAT,CAA2B,WAA3B,EAAwC,YAAY;AACnDyQ,eAAaS,SAAb,GAAyB,aAAzB;AACA,EAFD;;AAIAtX,UAASoG,gBAAT,CAA2B,SAA3B,EAAsC,YAAY;AACjDyQ,eAAaS,SAAb,GAAyBP,qBAAzB;AACA,EAFD;;AAIA;AACAE,sBAAqB7Q,gBAArB,CAAuC,OAAvC,EAAgD,UAAWkC,KAAX,EAAmB;AAClEA,QAAMoL,cAAN;;AAEA,MAAK1T,SAASuX,cAAT,KAA4B,IAAjC,EAAwC;AACvCN,wBAAqBD,WAArB,GAAmC,iBAAnC;AACAhX,YAASuX,cAAT,GAA0B,KAA1B;AACA,GAHD,MAGO;AACNN,wBAAqBD,WAArB,GAAmC,aAAnC;AACAhX,YAASuX,cAAT,GAA0B,IAA1B;AACA;AACD,EAVD,EAUG,KAVH;AAWA","file":"app.js","sourcesContent":["let siteConfig = {\n\tsiteURL: 'http://numinoustechnologies.com/animus/',\n\tshareText: 'Welcome to the Animus. Enter the 360º experience and discover the weapons and armor of the Assassins and Templars.',\n\tsiteTweet: 'Welcome to the Animus. Enter the 360º experience and discover the weapons and armor of the Assassins and Templars. #AssassinsCreed [URL]',\n\tassetShare: 'I entered the 360º Animus and discovered the [Object Name], an ancient artifact of Assassins\\' lore. Enter the Animus now to uncover ancient Assassins and Templar relics.',\n\tassetTweet: 'I entered the 360º Animus and discovered the [Object Name].'\n}\n\nlet position = {\n\tlon: 30\n}\nlet curPosX = 30;\nlet fovMin = 75;\nlet fovMax = 50;\nlet onPointerDownPointerX;\nlet onPointerDownLon;\nlet blocked = false;\nlet touchStartX;\nlet mouseStartX;\n\n//************************************************************************//\n//                             Init Loader                                //\n//************************************************************************//\n\n//************************************************************************//\n//                              Variables                           \t  //\n//************************************************************************//\n\nlet camera, container, color, controls, clock, delta, deviceControls, h, hotspot, info, logoGeo, logoMaterial, logoMesh, logoTexture, marker, mesh, materials = [], mouse, mousePos, objects = [], parameters, particles, particleMaterial, rainDensity = 20000, rainGeometry, raycaster, renderer, scene, size, smokeParticles = [], spotLight, spotLightHelper, sprite, stats;\nlet layer = false;\nlet hsParticles = [];\nlet rotateSpeed = 0.03\nlet hotspots = [];\nlet hotspotObjects = [\n\t{\n\t\tid: 0,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'Bladed Spear de Bilboa',\n\t\t\t\timage: 'textures/weapons/bladed-spear-de-bilboa.png',\n\t\t\t\tkey: 'bladed-spear-de-bilboa',\n\t\t\t\tdescription: 'this bladed spear is sure to keep enemies at bay. with a heavy ash base and a finely hewn blade forged by bilboan craftsmen, in the hands of an assassin this weapon can defeat an entire batallion of templar enemies.'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Assassin\\'s Hidden Blade',\n\t\t\t\timage: 'textures/weapons/assassins-hidden-blade.png',\n\t\t\t\tkey: 'assassins-hidden-blade',\n\t\t\t\tdescription: 'this simple leather vambrace as an essential piece of every assassin’s outfit. the\u0003 blade-concealing armor both proects from attacks and gives the assassin access to a deadly hidden blade with a simple flick of the wrist.'\n\t\t\t}\n\t\t],\n\t\tlon: 19,\n\t\tposition: [450, 0, 150],\n\t},\n\t{\n\t\tid: 1,\n\t\tlon: 39,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'Córdoban Halberd',\n\t\t\t\timage: 'textures/weapons/cordoban-halberd.png',\n\t\t\t\tkey: 'cordoban-halberd',\n\t\t\t\tdescription: 'the córdoban halberd combines the intricate artistrty of the monarchy with the unparalleled killing power of the inquisition. featuring tempered steel and ornate gold gilding in the staff, this weapon is both beautiful and deadly.'\n\t\t\t}\n\t\t],\n\t\tposition: [370, 0, 280],\n\t},\n\t{\n\t\tid: 2,\n\t\tlon: 87.5,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'Legendary Prowler Hood',\n\t\t\t\timage: 'textures/weapons/legendary-prowler-hood.png',\n\t\t\t\tkey: 'legendary-prowler-hood',\n\t\t\t\tdescription: 'if you’re talking stealth look no further than the legendary prowler hood. this stylish-but-effecient garb features discreet pockets for hidden blades and gives any assassin the ability to disappear into a crowd at a moment’s notice.'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Assassin\\'s Hidden Blade with Grappling Hook',\n\t\t\t\timage: 'textures/weapons/assassins-hidden-blade-with.png',\n\t\t\t\tkey: 'assassins-hidden-blade-with',\n\t\t\t\tdescription: 'these leather killing machines hide a deadly blade on the right wrist and a powerful propulsive grappling hook on the left, creating a gauntlet of pain \u0003and dexterity unsurprassed throughout the kingdom.'\n\t\t\t}\n\t\t],\n\t\tposition: [25, 0, 400],\n\t},\n\t{\n\t\tid: 3,\n\t\tlon: 106,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'Shadow Brigadine',\n\t\t\t\timage: 'textures/weapons/shadow-brigandine.png',\n\t\t\t\tkey: 'shadow-brigandine',\n\t\t\t\tdescription: 'this obsidian chainmail armor gives any assassin the ability to bleed into the shadows undetected, all the better to stalk and eliminate their templar prey.'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Blade de Barcelona',\n\t\t\t\timage: 'textures/weapons/blade-de-barcelona.png',\n\t\t\t\tkey: 'blade-de-barcelona',\n\t\t\t\tdescription: 'this curved blade was created by the greatest assassin craftsmen of barcelona to withstand blows from the strongest of weaponry. it’s unqiue curved design is designed to deflect direct blows from swords, spears and sabres.'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Long Sword de Don Quixote',\n\t\t\t\timage: 'textures/weapons/long-sword-de-don-quixote.png',\n\t\t\t\tkey: 'long-sword-de-don-quixote',\n\t\t\t\tdescription: 'this long sword, rumored to be owned by the legendary warrior don quixote, features tempered steel and a gold-infused hilt. just don’t try to fight a \u0003windmill with it. things probably won’t work out the way you want them to.'\n\t\t\t}\n\t\t],\n\t\tposition: [-115, 0, 400],\n\t},\n\t{\n\t\tid: 4,\n\t\tlon: 153,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'Bow de silencio',\n\t\t\t\timage: 'textures/weapons/bow-de-silencio.png',\n\t\t\t\tkey: 'bow-de-silencio',\n\t\t\t\tdescription: 'your enemy will hear naught but the wind rustling through the trees as you release the string on this silent but deadly longbow. using arrows forged from strong spanish oak, this stealth weapon is a key in every assassin’s arsenal.'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Piece of Eden',\n\t\t\t\timage: 'textures/weapons/piece-of-eden.png',\n\t\t\t\tkey: 'piece-of-eden',\n\t\t\t\tdescription: 'this mysterious orb is rumored by many to unlock the mysteries of mind \u0003control, allowing the owner to manipulate freedom of thought. so if you’ve ever felt like an assassin was reading your mind, odds are you’re probably right.'\n\t\t\t}\n\t\t],\n\t\tposition: [-400, 0, 205],\n\t},\n\t{\n\t\tid: 5,\n\t\tlon: 175,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'Umbrella Blade',\n\t\t\t\timage: 'textures/weapons/umbrella-blade.png',\n\t\t\t\tkey: 'umbrella-blade',\n\t\t\t\tdescription: 'this stealthy blade is not what you think it is. disguised as an early version of an umbrella, the hidden steel contained within is just as deadly as any weapon in the assassin’s collection.'\n\t\t\t},\n\t\t\t// missing slide here, \"Cloak of Midnight\"\n\t\t\t{\n\t\t\t\ttitle: 'Ceremonial Digit Removal Blade',\n\t\t\t\timage: 'textures/weapons/ceremonial-digit-removal-blade.png',\n\t\t\t\tkey: 'ceremonial-digit-removal-blade',\n\t\t\t\tdescription: 'a shared touchpoint on every assassin’s journey involves this ceremonial digit removal blade. used to prove the assassin’s loyalty to the cause, seeing \u0003this device in a master assassin’s hands means final admittance to a very \u0003exclusive club...and a fairly uncomfortable afternoon.'\n\t\t\t}\n\t\t],\n\t\tposition: [-445, 0, 30],\n\t},\n\t{\n\t\tid: 6,\n\t\tlon: 236,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'Smoke Bombs',\n\t\t\t\timage: 'textures/weapons/smoke-bombs.png',\n\t\t\t\tkey: 'smoke-bombs',\n\t\t\t\tdescription: 'used for both attack and escape, these pouch bombs use a combination of \u0003gunpowder, sulfur, and secret alchemy to create a variety of effects, from \u0003explosions to smoke screens. perfect for destraction...or destruction.'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Pistola de Pyreness',\n\t\t\t\timage: 'textures/weapons/pistola-de-pyrenees.png',\n\t\t\t\tkey: 'pistola-de-pyrenees',\n\t\t\t\tdescription: 'this pistola is an exclellent choice when stealth is no longer an option. \u0003perfect for disorienting groups of enemies or eliminating a lone inquisitor, this weapon is essential for every assassin in the field (or the mountains).'\n\t\t\t}\n\t\t\t// missing slide, piece of eden (gold)\n\t\t],\n\t\tposition: [-265, 0, -380],\n\t},\n\t{\n\t\tid: 7,\n\t\tlon: 262.5,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'Elche de Ballesta',\n\t\t\t\timage: 'textures/weapons/elche-de-ballesta.png',\n\t\t\t\tkey: 'elche-de-ballesta',\n\t\t\t\tdescription: 'this powerful crossbow fires tungsten bolts at a velocity unmatched in ancient times, providing assassins with a silent option for long-range attacks.'\n\t\t\t}\n\t\t],\n\t\tposition: [-60, 0, -455],\n\t},\n\t{\n\t\tid: 8,\n\t\tlon: 286.5,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'Inquisitors Shield',\n\t\t\t\timage: 'textures/weapons/inquisitors-shield.png',\n\t\t\t\tkey: 'inquisitors-shield',\n\t\t\t\tdescription: 'this standard bronze shield “borrowed” from the spanish inquisition gives assassin’s a powerful defensive tool for use in seige, or a valuable prop when infiltrating a spanish dungeon.'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Armada Bow',\n\t\t\t\timage: 'textures/weapons/armada-bow.png',\n\t\t\t\tkey: 'armada-bow',\n\t\t\t\tdescription: 'this powerful longbow favored by spanish seamen provides hightened accuracy and increased distance for maximum killing power. if that’s a thing you’re \u0003looking for.'\n\t\t\t}\n\t\t],\n\t\tposition: [125, 0, -455],\n\t},\n\t{\n\t\tid: 9,\n\t\tlon: 332,\n\t\tslides: [\n\t\t\t{\n\t\t\t\ttitle: 'Blade of the Assassin',\n\t\t\t\timage: 'textures/weapons/blades-of-the-assassin.png',\n\t\t\t\tkey: 'blades-of-the-assassin',\n\t\t\t\tdescription: 'whether leaping from a ledge or silently stalking a victim through a crowded marketplace, an assassin is only as good as his blades. featuring a variety of shapes and sizes customizable to its owner, no self-respecting assassin would be caught dead without one of these handy weapons.'\n\t\t\t}\n\t\t],\n\t\tposition: [400, 0, -205]\n\t},\n];\nlet onMouseDownMouseX = 0, onMouseDownMouseY = 0,\nonMouseDownLon = 0,\nlat = 0, onMouseDownLat = 0,\nphi = 0, theta = 0;\n\ncontainer = document.getElementById( 'container' );\n\nlet containerWidth = container.clientWidth;\nlet containerHeight = container.clientHeight;\n\nlet selectedObjects = [];\nlet loader;\nlet renderPass;\nlet outlinePass;\nlet composer;\nlet effectFXAA;\n// let controlsEnabled = true;\nlet showingModal = false;\nlet initialOrientation;\nlet isUserInteracting = false;\nlet freeze;\n\nlet projector = new THREE.Projector();\nlet mouseVector = new THREE.Vector3();\n\nlet currentHotspot;\n\nlet touchDevice\nif (('ontouchstart' in window) || window.DocumentTouch && document instanceof DocumentTouch) {\n\ttouchDevice = true;\n}\n\nlet showLoader = true;\nlet playAudio = true;\n// var audioLoader = new THREE.AudioLoader();\n// audioLoader.load(audioFile);\n\n\n\nlet audio;\nlet progressBar = $('.progress');\nlet numAnim = new CountUp(percent, 0, 0, 0, 0.5, {suffix: '%'});\nlet filesLoaded = 0;\nlet totalFiles = 0;\nfunction loadTick() {\n\tlet percent = filesLoaded/totalFiles*100;\n\tnumAnim.update(percent);\n\tprogressBar.css('width', `${percent}%`);\n\tif(percent === 100) {\n\t\tlet button = $('.splash button');\n\t\tTweenMax.to($('.info'), 550/1000, {autoAlpha: 0});\n\t\tTweenMax.to(button, 550/1000, {autoAlpha: 1});\n\t\tbutton.on('click', () => {\n\t\t\tTweenMax.to($('#preloader'), 750/1000, {delay: 550/1000, autoAlpha: 0, onComplete: () => {\n\t\t\t\taudio.volume = 0.5;\n\t\t\t\taudio.play();\n\t\t\t}});\n\t\t})\n\t}\n}\n\n// function preloadAudio(url) {\n// \ttotalFiles += 1;\n// \tlet audio = new Audio();\n// \taudio.addEventListener('canplaythrough', () => {\n// \t\tfilesLoaded += 1;\n// \t\tloadTick();\n// \t}, false);\n// \taudio.src = url;\n// \treturn audio;\n// }\n\n\n function preloadAudio(url) {\n    totalFiles += 1;\n    let audio = new Audio();\n    audio.addEventListener('canplaythrough', () => {\n\t\tconsole.log(\"CALLED\");\n        filesLoaded += 1;\n        loadTick();\n    }, false);\n    audio.addEventListener('error', () => {\n\t\tconsole.log(\"ERROR\", error);\n        filesLoaded += 1;\n        loadTick();\n    }, false);\n    audio.src = url;\n    audio.load();\n    return audio;\n}\n\nfunction preloadImages() {\n\tlet slides = hotspotObjects.map( hotspotObject => hotspotObject.slides ).reduce( (prev, current) => prev.concat(current) )\n\ttotalFiles += slides.length;\n\tslides.forEach((slide) => {\n\t\tlet image = new Image();\n\t\timage.onload = () => {\n\t\t\tfilesLoaded += 1;\n\t\t\tloadTick();\n\t\t}\n\t\timage.src = slide.image;\n\t});\n}\n\nif(showLoader) {\n\tpreloadImages();\n\taudio = preloadAudio('audio/bg-music.mp3');\n\tTHREE.DefaultLoadingManager.onProgress = function ( item, loaded, total ) {\n\t\tif(loaded === 1) totalFiles += total;\n\t\tfilesLoaded += 1;\n\t\tloadTick();\n\t};\n} else {\n\t$('#loader').hide();\n}\n\nfunction setupButtons() {\n\t$('.button-outer .logo').each(function() {\n\t\tvar $el = $(this);\n\t\tvar clone = $el.find('.clone').clone().attr('class', 'fill blur');\n\t\t$el.append(clone);\n\t});\n\t$('.inner-path').each(function() {\n\t\tvar $el = $(this);\n\t\tvar clone = $el.clone().attr('class', 'blur');\n\t\t$el.after(clone);\n\t});\n\t$('.button-outer').on('mouseenter', function() {\n\t\tvar key = $(this).attr('key');\n\t\tbuttons[key].animate(1);\n\t});\n\t$('.button-outer').on('mouseleave', (event) => {\n\t\tvar key = $(event.currentTarget).attr('key');\n\t\tbuttons[key].set(0);\n\t});\n}\n\nvar buttons = {};\n\n\n//************************************************************************//\n//                             Init Audio                                 //\n//************************************************************************//\n\n// let audio = document.createElement('audio');\n// let source = document.createElement('source');\n// source.src = 'audio/bg-music.mp3';\n// audio.appendChild(source);\n// audio.play();\n\nfunction Modal(hotspot) {\n\tthis.modal = $('.modal');\n\tthis.item = this.modal.find('.item');\n\tthis.content = this.modal.find('.content');\n\tthis.description = this.modal.find('.description');\n\tthis.title = this.modal.find('.title');\n\tthis.facebookShare = this.modal.find('.button-outer.fb');\n\tthis.twitterShare = this.modal.find('.button-outer.twitter');\n\tthis.nextButton = this.modal.find('.next');\n\tthis.prevButton = this.modal.find('.prev');\n\tthis.controls = this.modal.find('.controls');\n\t$('body').addClass('modal-open');\n\t$('.modal-container .close').on('click', () => {\n\t\tthis.hide();\n\t\t$('body').removeClass('modal-open');\n\t});\n\t$('.overlay').on('click', this.hide);\n\tthis.bindEvents();\n}\n\nModal.prototype = {\n\tbindEvents() {\n\t\tthis.nextButton.on('click', () => {\n\t\t\tthis.next();\n\t\t});\n\n\t\tthis.prevButton.on('click', () => {\n\t\t\tthis.prev();\n\t\t});\n\t\tthis.facebookShare.on('click', () => {\n\t\t\tthis.shareFacebook();\n\t\t});\n\t\tthis.twitterShare.on('click', () => {\n\t\t\tthis.shareTwitter();\n\t\t});\n\t},\n\tprev() {\n\t\tlet content = this.content;\n\t\tlet duration = this.duration;\n\t\tTweenMax.to(content, duration, {autoAlpha: 0, onComplete: () => {\n\t\t\tthis.offset = this.offset === 0 ? this.hotspot.slides.length-1 : this.offset-1;\n\t\t\tthis.setModalValues(this.hotspot.slides[this.offset]);\n\t\t\tTweenMax.to(content, duration, {autoAlpha: 1});\n\t\t}});\n\t},\n\tnext() {\n\t\tlet content = this.content;\n\t\tlet duration = this.duration;\n\t\tTweenMax.to(content, duration, {autoAlpha: 0, onComplete: () => {\n\t\t\tthis.offset = this.offset+1 === this.hotspot.slides.length ? 0 : this.offset+1;\n\t\t\tthis.setModalValues(this.hotspot.slides[this.offset]);\n\t\t\tTweenMax.to(content, duration, {autoAlpha: 1});\n\t\t}})\n\t},\n\t// share: {\n\t\tshareFacebook() {\n\t\t\tlet slide = this.hotspot.slides[this.offset];\n\t\t\tlet href = `${siteConfig.siteURL}${makeUrlParams(this.hotspot.id, this.offset)}`;\n\t\t\tlet picture = `${siteConfig.siteURL}${slide.image}`;\n\t\t\tFB.ui(\n\t\t\t{\n\t\t\t\tmethod: 'share',\n\t\t\t\thref: href,\n\t\t\t\ttitle: slide.title,\n\t\t\t\tpicture: picture,\n\t\t\t\t// caption: 'your_caption',\n\t\t\t\tdescription: siteConfig.assetShare.replace('[Object Name]', slide.title)\n\t\t\t },\n\t\t\t function(response){\n\t\t\t\t// your code to manage the response\n\t\t\t });\n\t\t},\n\t\tshareTwitter() {\n\t\t\tlet params = encodeURIComponent(makeUrlParams(this.hotspot.id, this.offset));\n\t\t\tlet url = `${siteConfig.siteURL}${params}`;\n\t\t\tlet slide = this.hotspot.slides[this.offset];\n\t\t\tlet text = siteConfig.assetTweet.replace('[Object Name]', slide.title)\n\t\t\t// .replace('[URL]', `${url}${params}`);\n\t\t\tlet hashtags = 'AssassinsCreed'\n\t\t\twindow.open(`http://twitter.com/intent/tweet?url=${url}&text=${text}&hashtags=${hashtags}`);\n\t\t},\n\t// },\n\tduration: 0.35,\n\toffset: 0,\n\tsetModalValues(hotspot) {\n\t\tthis.description.text(hotspot.description);\n\t\tthis.title.text(hotspot.title);\n\t\tthis.item.attr('src', hotspot.image);\n\t\tthis.modal.attr('class', `modal ${hotspot.key} open`);\n\t},\n\thide() {\n\t\tfreeze = false;\n\t\tthis.modal.attr('class', 'modal');\n\t\tfor(var i in buttons) {\n\t\t\tbuttons[i].set(0);\n\t\t}\n\t\tlet duration = 550/1000\n\t\tshowingModal = false;\n\t\tthis.controls.hide();\n\t\t// pointerLock();\n\t\tTweenMax.to($('.modal-container') , 0.3, {autoAlpha: 0, onComplete: function() {\n\t\t\t\tthis.modal.removeClass('open');\n\t\t\t}.bind(this)\n\t\t})\n\t\tTweenMax.to(camera, duration, {fov: fovMin, onComplete: function() {\n\t\t\tblocked = false;\n\t\t}});\n\t\t$(document).off('keydown');\n\t},\n\tshow(hotspot, subid) {\n\t\tthis.hotspot = hotspot;\n\t\tthis.subid = subid;\n\t\tthis.offset = 0;\n\t\t// let urlParams = makeUrlParams(hotspot.id);\n\t\t// history.replaceState(null, null, urlParams);\n\t\tlet duration = 550/1000;\n\t\tshowingModal = true;\n\t\tif(hotspot.slides && hotspot.slides.length > 0) {\n\t\t\tif(hotspot.slides.length > 1) this.controls.fadeIn();\n\t\t\tthis.activeSlide = hotspot.slides[this.offset];\n\t\t\tthis.setModalValues(this.activeSlide);\n\t\t}\n\t\tTweenMax.to($('.modal-container') , 0.3, {autoAlpha: 1});\n\t\tsetTimeout(() => {\n\t\t\tthis.modal.addClass('open');\n\t\t}, 200)\n\t\tTweenMax.to(camera, duration, {fov: fovMax, onComplete: () => {\n\t\t\t$('.modal-container').css({top: 0})\n\t\t\t$(document).on('keydown', (event) => {\n\t\t\t\tif(event.keyCode === 27) {\n\t\t\t\t\tmodal.hide();\n\t\t\t\t}\n\t\t\t});\n\t\t}})\n\t}\n}\nlet modal = new Modal();\nmodal.bindEvents();\n\n$(document).ready(function() {\n\n\t$('.button-outer').each((index, el) => {\n\t\tvar $el = $(el);\n\t\tvar key = $el.attr('key');\n\t\tbuttons[key] = new ProgressBar.Path($el.find('.outer-path').get(0), {\n\t\t\teasing: 'easeInOut',\n\t\t\tduration: 500\n\t\t});\n\t\tbuttons[key].set(0);\n\t});\n\n\t$('.button-outer').on('mouseenter', function() {\n\t\tvar key = $(this).attr('key');\n\t\tbuttons[key].animate(1);\n\t});\n\n\t$('.button-outer').on('mouseleave', (event) => {\n\t\tvar key = $(event.currentTarget).attr('key');\n\t\tbuttons[key].set(0);\n\t});\n\n\t$('.button-outer').on('click', (event) => {\n\t\tvar key = $(event.currentTarget).attr('key');\n\t\thandleButtonClick(key);\n\t});\n\n\tlet offLine = $('.sound line');\n\tlet container = offLine.parents('svg');\n\t$('.sound').on('click', () => {\n\t\tif(playAudio) {\n\t\t\taudio.pause();\n\t\t\toffLine.show();\n\t\t\tcontainer.attr('class', 'off');\n\t\t} else {\n\t\t\taudio.play();\n\t\t\toffLine.hide();\n\t\t\tcontainer.attr('class', '');\n\t\t}\n\t\tplayAudio = !playAudio;\n\t});\n\n\tsetupButtons();\n});\n\ninit();\nanimate();\n\n//************************************************************************//\n//                             Init Scene                                 //\n//************************************************************************//\n\nfunction init() {\n\n\tvar width = window.innerWidth || 1;\n\tvar height = window.innerHeight || 1;\n\tvar devicePixelRatio = window.devicePixelRatio || 1;\n\trenderer = new THREE.WebGLRenderer( { antialias: false } );\n\trenderer.physicallyCorrectLights = true;\n\trenderer.gammaInput = true;\n\trenderer.gammaOutput = true;\n\trenderer.shadowMap.enabled = true;\n\trenderer.gammaInput = true;\n\trenderer.gammaOutput = true;\n\trenderer.shadowMap.enabled = true;\n\trenderer.shadowMap.renderReverseSided = false;\n\trenderer.toneMapping = THREE.ReinhardToneMapping;\n\trenderer.toneMappingExposure = 0.8;\n\trenderer.setClearColor( 0xa0a0a0 );\n\trenderer.setPixelRatio( 1 );\n\trenderer.setSize( width, height );\n\n\tcamera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 1, 2000 );\n\tcamera.target = new THREE.Vector3( 0, 0, 0 );\n\tscene = new THREE.Scene();\n\n\tlet geometry = new THREE.SphereGeometry( 500, 60, 400 );\n\tgeometry.scale( - 1, 1, 1 );\n\n\tlet material = new THREE.MeshBasicMaterial( {\n\t\tmap: new THREE.TextureLoader().load( 'textures/AnimusPanorama_v4.jpg' ),\n\t\tfog: true,\n\t});\n\n\tmesh = new THREE.Mesh( geometry, material );\n\tmesh.name = 'scene';\n\tscene.add( mesh );\n\n\t// stats = initStats()\n\n\traycaster = new THREE.Raycaster();\n\tmouse = new THREE.Vector2();\n\n\t// bulb\n\t// let bulbLight = new THREE.PointLight( 0xffee88, 1, 100, 2 );\n\t// let bulbMat = new THREE.MeshStandardMaterial( {\n\t// \temissive: 0xffffee,\n\t// \temissiveIntensity: 1,\n\t// \tcolor: 0x000000\n\t// });\n\t// bulbLight.add(new THREE.Mesh( bulbGeometry, bulbMat));\n\t// bulbLight.position.set(0, 2, 0);\n\t// bulbLight.castShadow = true;\n\t// scene.add(bulbLight);\n\t// bulbMat.emissiveIntensity = bulbLight.intensity / Math.pow( 0.02, 2.0 );\n\n\tlet hemiLight = new THREE.HemisphereLight( 0xffffff, 0xffffff, 5 );\n\t// hemiLight.color.setHSL( 0.6, 1, 0.6 );\n\t// hemiLight.groundColor.setHSL( 0.095, 1, 0.75 );\n\themiLight.position.set(0, 200, 0);\n\tscene.add(hemiLight);\n\n\t// var hemiLight = new THREE.HemisphereLight( 0xddeeff, 0x0f0e0d, 0.1 );\n\t// hemiLight.intensity = 8;\n\t// scene.add( hemiLight );\n\n\t// Build items for raycaster clicks\n\tbuildHotspots();\n\n\t// Device Orientation Stuff\n\tdeviceControls = new DeviceOrientationController( camera, renderer.domElement );\n\tdeviceControls.connect()\n\tsetupControllerEventHandlers( deviceControls )\n\n\t// if (window.DeviceOrientationEvent) {\n\t// \tconsole.log(\"Wonderful, Our browser supports DeviceOrientation\");\n\t// \twindow.addEventListener(\"deviceorientation\", deviceOrientationListener, false);\n\t// \tdeviceControls = new THREE.DeviceOrientationControls( camera, renderer.domElement );\n\t// } else {\n\t// \tconsole.log(\"Sorry, your browser doesn't support Device Orientation\");\n\t// }\n\n\n\tclock = new THREE.Clock();\n\n\t// postprocessing\n\tcomposer = new THREE.EffectComposer( renderer );\n\trenderPass = new THREE.RenderPass( scene, camera );\n\tcomposer.addPass( renderPass );\n\toutlinePass = new THREE.OutlinePass( new THREE.Vector2(window.innerWidth, window.innerHeight), scene, camera);\n\n\toutlinePass.edgeStrength = 0.5;\n\toutlinePass.edgeGlow = 1.0;\n\toutlinePass.edgeThickness = 1.0;\n\toutlinePass.pulsePeriod = 0.1;\n\toutlinePass.visibleEdgeColor = {r: 255, g: 255, b: 255};\n\n\tcomposer.addPass( outlinePass );\n\t// @todo: prob dont need this texture but SHRUG\n\tvar onLoad = function(texture) {\n\t\toutlinePass.patternTexture = texture;\n\t\ttexture.wrapS = THREE.RepeatWrapping;\n\t\ttexture.wrapT = THREE.RepeatWrapping;\n\t};\n\tvar lod = new THREE.TextureLoader();\n\tlod.load(\n\t\t// resource URL\n\t\t'textures/tri_pattern.jpg',\n\t\t// Function when resource is loaded\n\t\tonLoad\n\t);\n\n\teffectFXAA = new THREE.ShaderPass(THREE.FXAAShader);\n\teffectFXAA.uniforms['resolution'].value.set(1 / window.innerWidth, 1 / window.innerHeight );\n\teffectFXAA.renderToScreen = true;\n\tcomposer.addPass( effectFXAA );\n\n\tcontainer.appendChild( renderer.domElement );\n\t// container.addEventListener(\"mousemove\", getPosition, false);\n\n\n\t// @todo: event aliasing\n\t// document.addEventListener(touchDevice ? 'touchstart' : 'mousedown', onDocumentMouseDown, false );\n\t// document.addEventListener(touchDevice ? 'touchmove' : 'mousemove', onDocumentMouseMove, false );\n\t// document.addEventListener(touchDevice ? 'touchend' : 'mouseup', onDocumentMouseUp, false );\n\n\tdocument.addEventListener('mousedown', onDocumentMouseDown, false );\n\tdocument.addEventListener('mousemove', onDocumentMouseMove, false );\n\tdocument.addEventListener('mouseup', onDocumentMouseUp, false );\n\n\tdocument.addEventListener( 'touchstart', onDocumentTouchStart, false );\n\tdocument.addEventListener( 'touchmove', onDocumentTouchMove, false );\n\t// document.addEventListener( 'touchend', onDocumentTouchEnd, false );\n\n\t// document.addEventListener( 'wheel', onDocumentMouseWheel, false );\n\twindow.addEventListener( 'resize', onWindowResize, false );\n\n\t// initRain();\n\t// buildSmoke();\n\torientCamera();\n\n\tdocument.body.appendChild( renderer.domElement );\n\n}\n\nfunction getUrlParams() {\n\tvar urlParams,\n\t\tmatch,\n\t    pl     = /\\+/g,  // Regex for replacing addition symbol with a space\n\t    search = /([^&=]+)=?([^&]*)/g,\n\t    decode = function (s) { return decodeURIComponent(s.replace(pl, \" \")); },\n\t    query  = window.location.search.substring(1);\n\n\turlParams = {};\n\twhile (match = search.exec(query))\n\t   urlParams[decode(match[1])] = decode(match[2]);\n\treturn urlParams;\n}\n\nfunction orientCamera() {\n\tvar urlParams = getUrlParams();\n\tif(urlParams.id) {\n\t\tlet id = parseInt(urlParams.id)\n\t\tlet hotspot = hotspotObjects.filter( hotspot => id === hotspot.id );\n\t\tif(hotspot) {\n\t\t\thotspot = hotspot[0]\n\t\t\tinitialOrientation = hotspot.lon;\n\t\t\tcurrentHotspot = hotspot\n\t\t\tmodal.show(hotspot);\n\t\t}\n\t}\n}\n\nlet buttonClicks = {\n\t'ig-header'() {\n\t\tconsole.log('igHeader');\n\t},\n\tfb() {\n\t\t// modal.share('fb');\n\t}\n}\nfunction handleButtonClick(key) {\n\tif(key in buttonClicks) buttonClicks[key]();\n}\n\nfunction buildHotspots() {\n\tloader = new THREE.JSONLoader();\n\tloader.load('js/new-ac-logo-e3.js', function(geometry) {\n\t// loader.load('js/ac-logo-simple.js', function(geometry) {\n\t// loader.load('js/ac-badge-big.js', function(geometry) {\n\t// loader.load('js/ac-badge.js', function(geometry) {\n\t// loader.load('js/ac-logo.js', function(geometry) {\n\t\thotspots = hotspotObjects.map( (hotspotObject, index) => {\n\t\t\tgeometry.center();\n\n\t\t\tlet scale = 5;\n\n\t\t\t// previous ac-logo.js scale\n\t\t\t// let scale = 10;\n\n\t\t\t// js/ac-badge-big.js\n\t\t\t// let scale = 45;\n\n\t\t\t//js/ac-logo-simple.js\n\t\t\t// let scale = 27;\n\n\t\t\t// let newMat = new THREE.MeshLambertMaterial()\n\n\t\t\tlet newMat = new THREE.MeshPhongMaterial( {\n\t\t\t\tcolor: 0xFFFFFF,\n\t\t\t\tspecular: 0x000000,\n\t\t\t\tshininess: 1000\n\t\t\t} )\n\n\t\t\tlet oldMat = new THREE.MeshBasicMaterial( { color: '#cccccc', opacity: 1 } )\n\n\t\t\tlet hotspot = new THREE.Mesh(geometry, newMat);\n\t\t\thotspot.name = `hotspot-${index}`;\n\t\t\tvar box = new THREE.Box3().setFromObject(hotspot);\n\t\t\thotspot.scale.x = hotspot.scale.y = hotspot.scale.z = scale\n\t\t\thotspot.rotation.x = .5*Math.PI\n\t\t\thotspot.hotspot = hotspotObject;\n\n\t\t\tlet hitboxGeo = new THREE.BoxBufferGeometry( box.getSize().x * scale * 1.2, box.getSize().x * scale * 1.2 , box.getSize().x * scale * 1.2 );\n\t\t\tlet hitboxMat = new THREE.MeshBasicMaterial({ visible: false });\n\t\t\t// {wireframe: true}\n\t\t\t// // hitboxMat.visible = false\n\t\t\tlet hitboxMesh = new THREE.Mesh( hitboxGeo, hitboxMat );\n\t\t\thitboxMesh.name = `hitbox-${index}`;\n\n\t\t\tlet hotspotLocation = hotspotObject.position;\n\n\t\t\tvar group = new THREE.Group();\n\t\t\tgroup.name = `group-${index}`\n\t\t\tgroup.position.set(hotspotLocation[0], hotspotLocation[1], hotspotLocation[2]);\n\t\t\tscene.add(group);\n\t\t\tgroup.add(hotspot);\n\t\t\tgroup.add(hitboxMesh);\n\n\t\t\treturn group;\n\n\t\t});\n\t});\n}\n\n// function buildSmoke() {\n// \t// Smoke Light\n// \tlet light = new THREE.DirectionalLight(0xffffff, 1.5);\n// \tlight.position.set(-1, 0, 1);\n// \tscene.add(light);\n//\n// \tlet directionalLight = new THREE.DirectionalLight(0xffffff);\n// \tdirectionalLight.position.set(1, 1, 1).normalize();\n// \tscene.add(directionalLight);\n//\n// \tlet smokeTexture = THREE.ImageUtils.loadTexture('https://s3-us-west-2.amazonaws.com/s.cdpn.io/95637/Smoke-Element.png');\n// \tlet smokeMaterial = new THREE.MeshLambertMaterial({\n// \t\tcolor: 0xffffff,\n// \t\tmap: smokeTexture,\n// \t\ttransparent: true\n// \t});\n// \tlet smokeGeo = new THREE.PlaneGeometry(500, 500);\n//\n// \tfor (let p = 0; p < 150; p++) {\n// \t\tlet particle = new THREE.Mesh(smokeGeo,smokeMaterial);\n// \t\tparticle.position.set(Math.random()*500-250,Math.random()*500-250,Math.random()*1000-100);\n// \t\tparticle.rotation.z = Math.random() * 360;\n// \t\tscene.add(particle);\n// \t\tsmokeParticles.push(particle);\n// \t}\n// }\n\n\n// function evolveSmoke() {\n// \tlet sp = smokeParticles.length;\n// \twhile(sp--) {\n// \t\tsmokeParticles[sp].rotation.z += (delta * 0.2);\n// \t}\n// }\n\n// function initRain() {\n// \trainGeometry = new THREE.Geometry();\n//\n// \tlet sprite1 = THREE.ImageUtils.loadTexture( \"textures/rain1.png\" ),\n// \tsprite2 = THREE.ImageUtils.loadTexture( \"textures/rain2.png\" ),\n// \tsprite3 = THREE.ImageUtils.loadTexture( \"textures/rain3.png\" ),\n// \tsprite4 = THREE.ImageUtils.loadTexture( \"textures/rain4.png\" ),\n// \tsprite5 = THREE.ImageUtils.loadTexture( \"textures/rain5.png\" );\n//\n// \tfor (let i = 0; i < rainDensity; i++ ) {\n// \t\tlet vertex = new THREE.Vector3();\n// \t\tvertex.x = Math.random() * 2000 - 1000;\n// \t\tvertex.y = Math.random() * 4000 + 500;\n// \t\tvertex.z = Math.random() * 2000 - 1000;\n//\n// \t\trainGeometry.vertices.push( vertex );\n// \t}\n//\n// \tparameters = [ [ [1.0, 0.2, 0.5], \tsprite2, 20 ],\n// \t\t\t\t   [ [0.95, 0.1, 0.5], \tsprite3, 15 ],\n// \t\t\t\t   [ [0.90, 0.05, 0.5], sprite1, 10 ],\n// \t\t\t\t   [ [0.85, 0, 0.5], \tsprite5, 8 ],\n// \t\t\t\t   [ [0.80, 0, 0.5], \tsprite4, 5 ],\n// \t\t\t\t   ];\n//\n// \tfor (let i = 0; i < parameters.length; i++ ) {\n//\n// \t\tcolor  = parameters[i][0];\n// \t\tsprite = parameters[i][1];\n// \t\tsize   = parameters[i][2];\n//\n// \t\tmaterials[i] = new THREE.PointCloudMaterial({\n// \t\t\tsize: size,\n// \t\t\tmap: sprite,\n// \t\t\tblending: THREE.AdditiveBlending,\n// \t\t\tdepthTest: false,\n// \t\t\ttransparent : true\n// \t\t});\n// \t\tmaterials[i].color.setHSL( color[0], color[1], color[2] );\n//\n// \t\tparticles = new THREE.PointCloud( rainGeometry, materials[i] );\n//\n// \t\tparticles.rotation.z = Math.random() * 0.20 + 0.10;\n//\n// \t\tscene.add( particles );\n// \t}\n// }\n\n// function animateRain() {\n// \t// console.log(\"I'M ANIMATING THINGS\");\n// \tlet time = Date.now() * 0.00005;\n//\n// \tfor (let i = 0; i < scene.children.length; i++ ) {\n//\n// \t\tlet object = scene.children[i];\n//\n// \t\tif ( object instanceof THREE.PointCloud ) {\n// \t\t\t// Not getting into the log here\n// \t\t\tconsole.log(\"I'M ANIMATING THINGS\");\n// \t\t\tif (i == 0) {\n// \t\t\t\tobject.translateY(-10);\n// \t\t\t}\n//\n// \t\t\tif (i > 0) {\n// \t\t\t\tif (layer)\n// \t\t\t\t\tobject.translateY(-10);\n// \t\t\t\telse\n// \t\t\t\t\tif(scene.children[i-1].position.y < ((window.innerHeight * -1) / 2 - 1000))\n// \t\t\t\t\t\tobject.translateY(-10);\n// \t\t\t}\n//\n// \t\t\tif ((object.position.y < window.innerHeight * -1 * 5)) {\n// \t\t\t\t\tobject.position.y = 500;\n// \t\t\t\t\tobject.position.x = 0;\n// \t\t\t\t\tif (i == 0) layer = true;\n// \t\t\t}\n// \t\t}\n// \t}\n//\n// \tfor (let i = 0; i < materials.length; i++ ) {\n//\n// \t\tcolor = parameters[i][0];\n//\n// \t\th = ( 360 * ( color[0] + time ) % 360 ) / 360;\n// \t\tmaterials[i].color.setHSL( h, color[1], color[2] );\n//\n// \t}\n// }\n\nfunction onWindowResize() {\n\tvar width = window.innerWidth || 1;\n\tvar height = window.innerHeight || 1;\n\tvar devicePixelRatio = window.devicePixelRatio || 1;\n\tcamera.aspect = width / height;\n\tcamera.updateProjectionMatrix();\n\trenderer.setSize( width, height );\n\tcomposer.setSize( width, height );\n\teffectFXAA.uniforms['resolution'].value.set(1 / window.innerWidth, 1 / window.innerHeight );\n}\n\n// function onDocumentTouchEnd() {\n// \tconsole.log('---- onDocumentTouchEnd ----');\n// }\n\nfunction onDocumentTouchStart(event) {\n\tif(event.touches && event.touches.length === 1) {\n\t\tlet touch = event.touches[0];\n\t\ttouchStartX = touch.pageX;\n\t\tcheckRaycasterCollisions(touch.pageX, touch.pageY);\n\t\tif(selectedObjects.length) {\n\t\t\tonDocumentMouseDown(event, true);\n\t\t\tfreeze = true;\n\t\t}\n\t} else {\n\t\tevent.preventDefault();\n\t}\n}\n\nfunction onDocumentTouchMove(event) {\n\tif(event.touches && event.touches.length) {\n\t\tvar delta = touchStartX - event.touches[0].pageX;\n\t\ttouchStartX = event.touches[0].pageX;\n\t\tposition.lon += delta;\n\t}\n}\n\nfunction addSelectedObject(object) {\n\tselectedObjects = [];\n\tselectedObjects.push(object);\n}\n\nfunction checkRaycasterCollisions(x, y) {\n\n\tvar mouse3D = new THREE.Vector3( ( x / window.innerWidth ) * 2 - 1,\n\t\t\t\t\t\t\t\t\t-( y / window.innerHeight ) * 2 + 1,\n\t\t\t\t\t\t\t\t\t0.5 );\n\traycaster.setFromCamera( mouse3D, camera );\n\tlet intersects = raycaster.intersectObjects(scene.children, true);\n\tlet items = intersects.filter( intersect => intersect.object.name.match(/hitbox/) );\n\tif(items.length) {\n\t\titems.forEach((item) => {\n\t\t\tlet target = item.object.parent.children[0]\n\t\t\tif(selectedObjects.indexOf(target) === -1) {\n\t\t\t\t$('body').addClass('hot');\n\t\t\t\taddSelectedObject(target);\n\t\t\t}\n\t\t});\n\t} else {\n\t\t$('body').removeClass('hot');\n\t\tselectedObjects = [];\n\t}\n\toutlinePass.selectedObjects = selectedObjects;\n}\n\n// function renderFeatureMesh() {\n// \tvar feature = $('.feature');\n\n// \tif(feature.find('canvas').length) return;\n// \tvar scene = new THREE.Scene();\n// \tvar camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);\n\n// \tvar renderer = new THREE.WebGLRenderer();\n// \trenderer.setSize(feature.width(), feature.height());\n// \tfeature.append(renderer.domElement);\n\n// \tvar geometry = new THREE.CubeGeometry(5, 5, 5);\n// \tvar material = new THREE.MeshLambertMaterial({\n// \t\tcolor: 0x00fff0\n// \t});\n// \tvar cube = new THREE.Mesh(geometry, material);\n// \tscene.add(cube);\n\n// \tcamera.position.z = 12;\n\n// \tvar pointLight = new THREE.PointLight(0xFFFFFF);\n\n// \tpointLight.position.x = 10;\n// \tpointLight.position.y = 50;\n// \tpointLight.position.z = 130;\n\n// \tscene.add(pointLight);\n\n// \tvar reqAnimFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.msRequestAnimationFrame;\n\n// \tvar render = function() {\n// \t\treqAnimFrame(render);\n\n// \t\tvar delta = Math.random() * (0.06 - 0.02) + 0.02;\n\n// \t\tcube.rotation.x += delta;\n// \t\tcube.rotation.y += delta;\n// \t\tcube.rotation.z -= delta;\n\n// \t\trenderer.render(scene, camera);\n// \t};\n\n// \trender();\n// }\n\n\nfunction makeUrlParams(id, subid) {\n\tlet str = '';\n\tif(id !== undefined || id !== null) {\n\t\tstr += `?id=${id}`;\n\t}\n\tif(!subid) subid = 0;\n\tstr += `&subid=${subid}`;\n\treturn str;\n}\n\nfunction tweenArc(start, end) {\n\tlet relativity;\n\tlet delta = start-end;\n\tlet absDelta = Math.abs(delta);\n\tif(start < end) {\n\t\trelativity = absDelta < 180 ? '+=' : '-=';\n\t} else {\n\t\trelativity = absDelta < 180 ? '-=' : '+=';\n\t}\n\treturn {value: 360-absDelta < absDelta ? 360-absDelta : absDelta, relativity: relativity};\n}\n\nfunction onDocumentMouseDown(event, isTouch) {\n\tif(freeze) return;\n\tisUserInteracting = true;\n\tmouseStartX = event.clientX;\n\tif(selectedObjects.length && !showingModal) {\n\t\tlet so = selectedObjects[0].hotspot;\n\t\tlet currentLon = position.lon\n\t\tlet hotspotLon = selectedObjects[0].hotspot.lon\n\t\tlet data = tweenArc(currentLon, hotspotLon);\n\n\t\tlet maxDelta = 40;\n\t\tlet delta = data.value;\n\t\tlet maxDura = 550;\n\t\tlet duration = ((delta/maxDelta)*maxDura)/1000;\n\n\t\tif(isTouch) {\n\t\t\tposition.lon = position.lon%360;\n\t\t\tcurPosX = position.lon;\n\t\t\tcurrentHotspot = so\n\t\t\tmodal.show(so, 0);\n\t\t} else {\n\t\t\tTweenMax.to(position, duration, {lon: `${data.relativity}${data.value}`, onComplete: function() {\n\t\t\t\tposition.lon = position.lon%360;\n\t\t\t\tcurPosX = position.lon;\n\t\t\t\tcurrentHotspot = so\n\t\t\t\tmodal.show(so, 0);\n\t\t\t}});\n\t\t}\n\t}\n}\n\nfunction rotateHotspots() {\n\thotspots.forEach( hotspot => hotspot.children[0].rotation.z += rotateSpeed * 0.5 );\n}\n\nfunction onDocumentMouseMove(event) {\n\tif(freeze) return;\n\tcheckRaycasterCollisions(event.clientX, event.clientY);\n\tif(isUserInteracting && !showingModal) {\n\t\tlet deltaX = mouseStartX - event.clientX;\n\t\tmouseStartX = event.clientX;\n\t\tlet movementX = 'movementX' in event || 'mozMovementX' in event || 'webkitMovementX' in event ? event.movementX || event.mozMovementX || event.webkitMovementX || 0 : deltaX || 0;\n\t\tlet movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;\n\t\tcurPosX += movementX;\n\t\tif(curPosX < 0) {\n\t\t\tcurPosX = 360 + curPosX;\n\t\t}\n\t\tif(curPosX > 360) {\n\t\t\tcurPosX = 0;\n\t\t}\n\t\tposition.lon = curPosX;\n\t}\n}\n\nfunction onDocumentMouseUp( event ) {\n\tisUserInteracting = false;\n\t// mouseStartX = 0;\n}\n\n// Zoom in & out | Need to limit this to the starting point and a endind point\nfunction onDocumentMouseWheel( event ) {\n\tif (camera.fov > 75) {\n\t\tcamera.fov = 75\n\t} else {\n\t\tcamera.fov += event.deltaY * 0.02;\n\t\tcamera.updateProjectionMatrix();\n\t}\n\t// camera.fov += event.deltaY * 0.02;\n\t// camera.updateProjectionMatrix();\n}\n\nfunction animate() {\n\trequestAnimationFrame( animate );\n\tupdate();\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n}\n\nfunction update() {\n\t// if ( isUserInteracting === false ) {\n\t// \t// lon += 0.1;\n\t// }\n\t// console.log('initialOrientation', lon, initialOrientation)\n\t// console.log('update', lon)\n\tif(initialOrientation) {\n\t\tposition.lon = initialOrientation;\n\t\tinitialOrientation = null;\n\t}\n\n\tlat = Math.max( - 85, Math.min( 85, lat ) );\n\tphi = THREE.Math.degToRad( 90 - lat );\n\ttheta = THREE.Math.degToRad( position.lon );\n\n\tcamera.target.x = 1 * Math.sin( phi ) * Math.cos( theta );\n\t// camera.target.y = 1 * Math.cos( phi );\n\tcamera.target.z = 1 * Math.sin( phi ) * Math.sin( theta );\n\tcamera.lookAt( camera.target );\n\n\t/*\n\t// distortion\n\tcamera.position.copy( camera.target ).negate();\n\t*/\n\t// let delta = clock.getDelta(), speed = delta * CAMERAMOVESPEED;\n\t// controls.update(delta);\n\t// spotLight.target = marker;\n\t// controls.update()\n\n\t// spotLightHelper.update()\n\t// stats.update()\n\tdelta = clock.getDelta();\n\n\t// evolveSmoke();\n\t// animateRain();\n\t// rotateHotspot();\n\trotateHotspots();\n\n\t// checkRaycasterCollisions();\n\n\t// rainEngine.update(0.01 * 0.5)\n\ttheta += 0.1;\n\t// let radius = 600;\n\t// camera.position.x = radius * Math.sin( THREE.Math.degToRad( theta ) );\n\t// camera.position.y = radius * Math.sin( THREE.Math.degToRad( theta ) );\n\t// camera.position.z = radius * Math.cos( THREE.Math.degToRad( theta ) );\n\t// camera.lookAt( scene.position );\n\t// if (window.innerWidth < 800) {\n\t// \tdeviceControls.update();\n\t// }\n\n\t// if (window.innerWidth < 768) {\n\t\t// deviceControls.update()\n\t\t// camera.lookAt(deviceControls.gamma)\n\t\t// console.log(deviceControls);\n\n\t\t// sconsole.log(\"DEVICE CONTROLS\", deviceControls);\n\t\t// deviceControls.alpha = 0\n\t\t// deviceControls.beta = 180\n\t\t// deviceControls.gamma = 90\n\t\t// deviceControls.updateAlphaOffsetAngle(0);\n\t// }\n\n\t// if (window.DeviceOrientationEvent) {\n\t// \twindow.addEventListener('deviceorientation', function(event) {\n\t// \t\tlet alpha = event.alpha;\n\t// \t\tlet beta = event.beta;\n\t// \t\tlet gamma = event.gamma;\n\t// \t\t// console.log(\"We on Mobile\")\n\t// \t\t// console.log(\"GAMMA\" gamma);\n\t// \t\tdeviceControls.update();\n\t// \t\t// Do something\n\t// \t}, false);\n\t// }\n\n\tdeviceControls.update()\n\n\t// deviceControls.connect();\n\trenderer.render( scene, camera );\n\t// renderer.render( scene, camera );\n\tcamera.updateProjectionMatrix();\n\tcomposer.render();\n\t// renderer.autoClear = true;\n\t// renderer.setClearColor( 0xfff0f0 );\n\t// renderer.setClearAlpha( 0.0 );\n}\n\nTweenLite.ticker.addEventListener(\"tick\", render);\n\n// function initStats() {\n// \t// stats.setMode(0); // 0: fps, 1: ms\n// \t// Align top-left\n// \tstats = new Stats();\n// \tstats.domElement.style.position = 'absolute';\n// \t// stats.domElement.style.bottom = '0px';\n// \tstats.domElement.style.left = '0px';\n// \tstats.domElement.style.top = '0px';\n// \tstats.domElement.style.zIndex = 100;\n// \tcontainer.appendChild(stats.domElement);\n// \treturn stats;\n// }\n\n\n// function deviceOrientationListener(event) {\n// \tlet deg2rad = Math.PI / 180;\n// \tcamera.rotation.set(\n//         !event.beta * deg2rad,\n//         !event.gamma ? 0 : event.gamma * deg2rad,\n//         !event.alpha ? 0 : event.alpha * deg2rad\n//     );\n//\n// \tconsole.log(event.beta * deg2rad)\n// \tconsole.log(event.gamma * deg2rad)\n// \tconsole.log(event.alpha * deg2rad)\n//\n//         // console.log(\"Do Stuff With Device\", event);\n//         // ctx.clearRect(0, 0, c.width, c.height);\n//         // ctx.fillStyle = \"#FF7777\";\n//         // ctx.font = \"14px Verdana\";\n//         // ctx.fillText(\"Alpha: \" + Math.Round(event.alpha), 10, 20);\n//         // ctx.beginPath();\n//         // ctx.moveTo(180, 75);\n//         // ctx.lineTo(210, 75);\n//         // ctx.arc(180, 75, 60, 0, event.alpha * Math.PI / 180);\n//         // ctx.fill();\n// \t\t//\n//         // ctx.fillStyle = \"#FF6600\";\n//         // ctx.fillText(\"Beta: \" + Math.round(event.beta), 10, 140);\n//         // ctx.beginPath();\n//         // ctx.fillRect(180, 150, event.beta, 90);\n// \t\t//\n//         // ctx.fillStyle = \"#FF0000\";\n//         // ctx.fillText(\"Gamma: \" + Math.round(event.gamma), 10, 270);\n//         // ctx.beginPath();\n//         // ctx.fillRect(90, 340, 180, event.gamma);\n// }\n\n//DeviceOrientationController event handling\nfunction setupControllerEventHandlers( controls ) {\n\n\tvar controllerEl = document.querySelector( '#controllername' );\n\tvar controllerDefaultText = controllerEl.textContent;\n\tvar controllerSelectorEl = document.querySelector( '#controllertype' );\n\tvar compassCalibrationPopupEl = document.querySelector( '#calibrate-compass-popup' );\n\n\t// Listen for manual interaction (zoom OR rotate)\n\tcontrols.addEventListener( 'userinteractionstart', function () {\n\t\trenderer.domElement.style.cursor = 'move';\n\t\tcontrollerSelectorEl.style.display = 'none';\n\t});\n\n\tcontrols.addEventListener( 'userinteractionend', function () {\n\t\trenderer.domElement.style.cursor = 'default';\n\t\tcontrollerSelectorEl.style.display = 'inline-block';\n\t});\n\n\t// Listen for manual rotate interaction\n\tcontrols.addEventListener( 'rotatestart', function () {\n\t\tcontrollerEl.innerText = 'Manual Rotate';\n\t});\n\n\tcontrols.addEventListener( 'rotateend', function () {\n\t\tcontrollerEl.innerText = controllerDefaultText;\n\t});\n\n\t// Listen for manual zoom interaction\n\tcontrols.addEventListener( 'zoomstart', function () {\n\t\tcontrollerEl.innerText = 'Manual Zoom';\n\t});\n\n\tcontrols.addEventListener( 'zoomend', function () {\n\t\tcontrollerEl.innerText = controllerDefaultText;\n\t});\n\n\t// Allow advanced switching between 'Quaternions' and 'Rotation Matrix' calculations\n\tcontrollerSelectorEl.addEventListener( 'click', function ( event ) {\n\t\tevent.preventDefault();\n\n\t\tif ( controls.useQuaternions === true ) {\n\t\t\tcontrollerSelectorEl.textContent = 'Rotation Matrix';\n\t\t\tcontrols.useQuaternions = false;\n\t\t} else {\n\t\t\tcontrollerSelectorEl.textContent = 'Quaternions';\n\t\t\tcontrols.useQuaternions = true;\n\t\t}\n\t}, false);\n}\n"]}