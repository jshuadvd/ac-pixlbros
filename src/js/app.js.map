{"version":3,"sources":["index.js"],"names":["window","addEventListener","lon","fovMin","fovMax","zoomed","onPointerDownPointerX","onPointerDownLon","manager","THREE","LoadingManager","onProgress","item","loaded","total","console","log","onLoad","onError","audio","document","createElement","source","src","appendChild","camera","container","color","controls","clock","delta","deviceControls","h","hotspot","hsParticles","info","layer","logoGeo","logoMaterial","logoMesh","logoTexture","marker","mesh","materials","mouse","mousePos","objects","parameters","particles","particleMaterial","rainDensity","rainGeometry","raycaster","renderer","rotateSpeed","scene","size","smokeParticles","spotLight","spotLightHelper","sprite","stats","hotspots","hotspotLocations","isUserInteracting","onMouseDownMouseX","onMouseDownMouseY","onMouseDownLon","lat","onMouseDownLat","phi","theta","getElementById","init","animate","loader","PerspectiveCamera","innerWidth","innerHeight","target","Vector3","Scene","geometry","SphereGeometry","scale","material","MeshBasicMaterial","map","TextureLoader","load","fog","Mesh","name","add","initStats","DeviceOrientationControls","Raycaster","Vector2","buildHotspots","PI2","Math","PI","PointerLockControls","getObject","Clock","WebGLRenderer","antialias","alpha","setPixelRatio","devicePixelRatio","setSize","domElement","getPosition","onDocumentMouseDown","onDocumentMouseMove","onDocumentMouseUp","onDocumentTouchStart","onDocumentMouseWheel","event","preventDefault","dataTransfer","dropEffect","body","style","opacity","reader","FileReader","image","result","needsUpdate","readAsDataURL","files","onWindowResize","initRain","buildHotspot","JSONLoader","hotspotLocation","index","center","box","Box3","setFromObject","x","y","z","rotation","hitboxGeo","BoxBufferGeometry","getSize","hitboxMat","wireframe","hitboxMesh","group","Group","position","set","buildSmoke","light","DirectionalLight","directionalLight","normalize","smokeTexture","ImageUtils","loadTexture","smokeMaterial","MeshLambertMaterial","transparent","smokeGeo","PlaneGeometry","p","particle","random","push","evolveSmoke","sp","length","crossOrigin","evolveHotspot","hs","Geometry","sprite1","sprite2","sprite3","sprite4","sprite5","i","vertex","vertices","PointCloudMaterial","blending","AdditiveBlending","depthTest","setHSL","PointCloud","animateRain","time","Date","now","children","object","translateY","aspect","updateProjectionMatrix","clientX","touches","clientY","setFromCamera","intersects","intersectObjects","forEach","intersect","parent","rotateHotspots","fov","deltaY","requestAnimationFrame","update","max","min","degToRad","sin","cos","lookAt","getDelta","render","Number","undefined","scrollLeft","documentElement","scrollTop","offsetLeft","offsetTop","Stats","left","top","zIndex"],"mappings":"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","file":"app.js","sourcesContent":["window.addEventListener('load', function() {\n\n\tlet lon = 30;\n\t// let lat = 0;\n\t// let phi = 0;\n\t// let theta = 0;\n\tlet fovMin = 75;\n\tlet fovMax = 55;\n\tlet zoomed;\n\n\tlet onPointerDownPointerX;\n\tlet onPointerDownLon;\n\t// let onPointerDownLat;\n\n\n\t//************************************************************************//\n\t//                             Init Loader                                //\n\t//************************************************************************//\n\n\n\tlet manager = new THREE.LoadingManager();\n\n\tmanager.onProgress = function (item, loaded, total) {\n\t\titem = 'textures/AC-Logo.png'\n\t    console.log(item, loaded, total);\n\t};\n\tmanager.onLoad = function () {\n\t    console.log('all items loaded');\n\t\treturn item\n\t};\n\tmanager.onError = function () {\n\t    console.log('there has been an error');\n\t};\n\n\n\t//************************************************************************//\n\t//                             Init Audio                                 //\n\t//************************************************************************//\n\n\tlet audio = document.createElement('audio');\n\tlet source = document.createElement('source');\n\tsource.src = '/audio/AC-Trailer.mp3';\n\taudio.appendChild(source);\n\t// audio.play();\n\n\t//************************************************************************//\n\t//                              Variables                           \t  //\n\t//************************************************************************//\n\n\tlet camera, container, color, controls, clock, delta, deviceControls, h, hotspot, hsParticles = [], info, layer = false, logoGeo, logoMaterial, logoMesh, logoTexture, marker, mesh, materials = [], mouse, mousePos, objects = [], parameters, particles, particleMaterial, rainDensity = 20000, rainGeometry, raycaster, renderer, rotateSpeed = 0.1, scene, size, smokeParticles = [], spotLight, spotLightHelper, sprite, stats; \n\n\tlet hotspots = [];\n\tlet hotspotLocations = [\n\t\t[-20, 0, -475], // -475Z\n\t\t[145, 0, -475], // -475Z\n\t\t[345, 0, -205], // -475Z\n\t\t[-235, 0, -435], // -435Z\n\t\t[-445, 0, -25], // -405Z\n\t\t[450, 0, 90],\n\t\t[400, 0, 225],\n\t\t[65, 0, 400],\n\t\t[-95, 0, 400],\n\t\t[-270, 0, 105]\n\t];\n\n\tlet isUserInteracting = true,\n\tonMouseDownMouseX = 0, onMouseDownMouseY = 0,\n\tonMouseDownLon = 0,\n\tlat = 0, onMouseDownLat = 0,\n\tphi = 0, theta = 0;\n\n\tcontainer = document.getElementById( 'container' );\n\n\tinit();\n\tanimate();\n\n\t//************************************************************************//\n\t//                             Init Scene                                 //\n\t//************************************************************************//\n\n\tlet loader;\n\n\tfunction init() {\n\n\t\tcamera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 1, 2000 );\n\t\tcamera.target = new THREE.Vector3( 0, 0, 0 );\n\t\tscene = new THREE.Scene();\n\t\t// scene.fog = new THREE.FogExp2( 0x000000, 0.0008 );\n\t\t// scene.fog = new THREE.FogExp2(0x000000, 0.005);\n\t\t// scene.fog = new THREE.Fog(0x000000, 0.0008);\n\n\t\tlet geometry = new THREE.SphereGeometry( 500, 60, 400 );\n\t\tgeometry.scale( - 1, 1, 1 );\n\n\t\tlet material = new THREE.MeshBasicMaterial( {\n\t\t\tmap: new THREE.TextureLoader().load( 'textures/AnimusPanorama.jpg' ),\n\t\t\tfog: true,\n\t\t});\n\t\t\n\t\tmesh = new THREE.Mesh( geometry, material );\n\t\tmesh.name = 'scene';\n\t\tscene.add( mesh );\n\t\t\n\t\tstats = initStats()\n\t\t\n\t\tdeviceControls = new THREE.DeviceOrientationControls( camera, );\n\t\t\n\t\traycaster = new THREE.Raycaster();\n\t\tmouse = new THREE.Vector2();\n\t\t\n\t\t// Build items for raycaster clicks\n\t\tbuildHotspots();\n\n\t\tlet PI2 = Math.PI * 2;\n\t\t// particleMaterial = new THREE.SpriteCanvasMaterial( {\n\n\t\t// \tcolor: 0x000000,\n\t\t// \tprogram: function ( context ) {\n\n\t\t// \t\tcontext.beginPath();\n\t\t// \t\tcontext.arc( 0, 0, 0.5, 0, PI2, true );\n\t\t// \t\tcontext.fill();\n\n\t\t// \t}\n\n\t\t// } );\n\t\t\n\t\t// let logoGeo = THREE.PlaneGeometry( 5, 20, 32 );\n\t\t// let logo = new THREE.MeshBasicMaterial({\n\t\t// \tmap: new THREE.TextureLoader().load( 'textures/assassins_creed_logo.jpg' ),\n\t\t// })\n\t\t\n\t\t// let logoMesh = new THREE.Mesh(logoGeo, logo);\n\t\t// scene.add(logoMesh)\n\t\t// \n\n\t\t\n\t\t// let spotLight = new THREE.SpotLight(0xffffff, 40, 40);\n\t\t// camera.add(spotLight);\n\t\t// spotLight.position.set(0, 0,1);\n\t\t// spotLight.target = mesh;\n\t\t// add light\n\t\t// let light = new THREE.DirectionalLight(0xffffff, 1);\n\t\t// light.position.set(0,0,0);\n\t\t// scene.add(light);\n\t\t\n\t\t// let light = new THREE.SpotLight(0xffffff, 2.0, 1000);\n\t\t// light.target = mesh;\n\t\t// scene.add(light)\n\t\t// \n\t\t// let lightHelper = new THREE.SpotLightHelper(light);\n\t\t// scene.add(lightHelper)\n\t\t\n\t\t// spotLight = new THREE.SpotLight( 0xffffff, 2, 100 );\n\t\t// spotLight.position.set(0, 0, 0 );\n\t\t// spotLight.target = mesh\n\t\t// spotLight.position.set(20, 20, 20);\n\t\t// spotLight.castShadow = true;\n\t\t// spotLight.angle = Math.PI / 4;\n\t\t// spotLight.penumbra = 0.05;\n\t\t// spotLight.decay = 2;\n\t\t// spotLight.distance = 200;\n\t\t// spotLight.shadow.mapSize.width = 100;\n\t\t// spotLight.shadow.mapSize.height = 100;\n\t\t// spotLight.shadow.camera.near = 1;\n\t\t// spotLight.shadow.camera.far = 10;\n\t\t// spotLight.position.set(-20, 60, -10);\n\t    // spotLight.castShadow = true;\n\t\t// scene.add( spotLight );\n\t\t// camera.add(spotLight);\n\t\t// scene.add(camera)\n\n\t\t// spotLightHelper = new THREE.SpotLightHelper( spotLight );\n\t\t// scene.add( spotLightHelper );\n\t\t\t\n\t\t// marker = new THREE.Object3D();\n\t\t// marker.position.set(400, 300, 400);\n\t\t// marker.add(spotLight);\n\t\t// scene.add(marker);\n\t\t\n\t\tcontrols = new THREE.PointerLockControls( camera );\n\t\tscene.add( controls.getObject() );\n\t\t\n\t\tclock = new THREE.Clock();\n\t    \n\t\t// logoGeo = new THREE.PlaneGeometry(300,300);\n\t    // THREE.ImageUtils.crossOrigin = ''; //Need this to pull in crossdomain images from AWS\n\t    // logoTexture = THREE.ImageUtils.loadTexture('https://s3-us-west-2.amazonaws.com/s.cdpn.io/95637/quickText.png');\n\t    // logoMaterial = new THREE.MeshLambertMaterial({color: 0x00ffff, opacity: 0.1, map: logoTexture, transparent: true, blending: THREE.AdditiveBlending})\n\t    // logoMesh = new THREE.Mesh(logoGeo, logoMaterial);\n\t    // logoMesh.position.z = 800;\n\t    // scene.add(logoMesh);\n\t\t\n\t\t// logoGeo = new THREE.PlaneGeometry(1024, 1024);\n\t    // THREE.ImageUtils.crossOrigin = ''; \n\t    // logoTexture = THREE.ImageUtils.loadTexture('/textures/AC-Logo.png');\n\t    // logoMaterial = new THREE.MeshLambertMaterial({\n\t\t// \t// color: 0xffffff, \n\t\t// \topacity: 2.1, \n\t\t// \tmap: logoTexture\n\t\t// })\n\t    // logoMesh = new THREE.Mesh(logoGeo, logoMaterial);\n\t    // scene.add(logoMesh);\n\t\t\n\t\trenderer = new THREE.WebGLRenderer({\n\t\t\tantialias: true,\n\t\t\talpha: true,\n\t\t});\n\t\trenderer.setPixelRatio( window.devicePixelRatio );\n\t\trenderer.setSize( window.innerWidth, window.innerHeight );\n\t\tcontainer.appendChild( renderer.domElement );\n\t\tcontainer.addEventListener(\"mousemove\", getPosition, false);\n\t\t\n\t\tdocument.addEventListener( 'mousedown', onDocumentMouseDown, false );\n\t\tdocument.addEventListener( 'mousemove', onDocumentMouseMove, false );\n\t\tdocument.addEventListener( 'mouseup', onDocumentMouseUp, false );\n\t\tdocument.addEventListener( 'touchstart', onDocumentTouchStart, false );\n\t\tdocument.addEventListener( 'wheel', onDocumentMouseWheel, false );\n\t\t// document.addEventListener( 'mousedown', onDocumentMouseDown, false );\n\t\t// document.addEventListener( 'keydown', onKeyDown, false );\n\t\t// document.addEventListener( 'keyup', onKeyUp, false );\n\t\t// document.addEventListener(\"DOMContentLoaded\", init, false);\n\n\t\t// document.addEventListener('click', click, false);\n\n\t\tdocument.addEventListener( 'dragover', function ( event ) {\n\n\t\t\tevent.preventDefault();\n\t\t\tevent.dataTransfer.dropEffect = 'copy';\n\n\t\t}, false );\n\n\t\tdocument.addEventListener( 'dragenter', function ( event ) {\n\n\t\t\tdocument.body.style.opacity = 0.5;\n\n\t\t}, false );\n\n\t\tdocument.addEventListener( 'dragleave', function ( event ) {\n\n\t\t\tdocument.body.style.opacity = 1;\n\n\t\t}, false );\n\n\t\tdocument.addEventListener( 'drop', function ( event ) {\n\n\t\t\tevent.preventDefault();\n\n\t\t\tlet reader = new FileReader();\n\t\t\treader.addEventListener( 'load', function ( event ) {\n\n\t\t\t\tmaterial.map.image.src = event.target.result;\n\t\t\t\tmaterial.map.needsUpdate = true;\n\n\t\t\t}, false );\n\t\t\treader.readAsDataURL( event.dataTransfer.files[ 0 ] );\n\n\t\t\tdocument.body.style.opacity = 1;\n\n\t\t}, false );\n\n\t\twindow.addEventListener( 'resize', onWindowResize, false );\n\t\t\n\t\tinitRain();\n\t\t// buildSmoke();\n\t\tbuildHotspot();\n\t\t\n\t\tdocument.body.appendChild( renderer.domElement );\n\t}\n\n\n\tfunction buildHotspots() {\n\t\tloader = new THREE.JSONLoader();\n\t\tloader.load('/js/ac-logo.js', function(geometry) {\n\t\t\thotspots = hotspotLocations.map( (hotspotLocation, index) => {\n\t\t\t\tgeometry.center();\n\t\t\t\tlet scale = 10;\n\t\t\t\tlet hotspot = new THREE.Mesh(geometry, new THREE.MeshBasicMaterial( { color: '#870000', opacity: 1 } ));\n\t\t\t\thotspot.name = `hotspot-${index}`;\n\t\t\t\tvar box = new THREE.Box3().setFromObject(hotspot);\n\t\t\t\thotspot.scale.x = hotspot.scale.y = hotspot.scale.z = scale\n\t\t\t\thotspot.rotation.x = Math.PI\n\n\t\t\t\t// hotspot.scale.x = 8\n\t\t\t\t// hotspot.scale.y = 10\n\t\t\t\t// hotspot.scale.z = 8\n\t\t\t\t// hotspot.rotation.y = 3\n\n\t\t\t\tlet hitboxGeo = new THREE.BoxBufferGeometry( box.getSize().x * scale * 1.2, 200, 10 );\n\t\t\t\tlet hitboxMat = new THREE.MeshBasicMaterial({wireframe: true});\n\t\t\t\t// // hitboxMat.visible = false\n\t\t\t\tlet hitboxMesh = new THREE.Mesh( hitboxGeo, hitboxMat );\n\t\t\t\thitboxMesh.name = `hitbox-${index}`;\n\n\t\t\t\tvar group = new THREE.Group();\n\t\t\t\tgroup.name = `group-${index}`\n\t\t\t\tgroup.position.set(hotspotLocation[0], hotspotLocation[1], hotspotLocation[2]);\n\t\t\t\tscene.add(group);\n\t\t\t\tgroup.add(hotspot);\n\t\t\t\tgroup.add(hitboxMesh);\n\n\t\t\t\treturn group;\n\n\t\t\t});\n\t\t});\n\t}\n\n\tfunction buildSmoke() {\n\t\t// Smoke Light\n\t    let light = new THREE.DirectionalLight(0xffffff, 1.5);\n\t    light.position.set(-1, 0, 1);\n\t    scene.add(light);\n\t\t\n\t\tlet directionalLight = new THREE.DirectionalLight(0xffffff);\n\t    directionalLight.position.set(1, 1, 1).normalize();\n\t    scene.add(directionalLight);\n\t  \n\t    let smokeTexture = THREE.ImageUtils.loadTexture('https://s3-us-west-2.amazonaws.com/s.cdpn.io/95637/Smoke-Element.png');\n\t    let smokeMaterial = new THREE.MeshLambertMaterial({\n\t\t\tcolor: 0xffffff, \n\t\t\tmap: smokeTexture, \n\t\t\ttransparent: true\n\t\t});\n\t    let smokeGeo = new THREE.PlaneGeometry(500, 500);\n\t     \n\t    for (let p = 0; p < 150; p++) {\n\t        let particle = new THREE.Mesh(smokeGeo,smokeMaterial);\n\t        particle.position.set(Math.random()*500-250,Math.random()*500-250,Math.random()*1000-100);\n\t        particle.rotation.z = Math.random() * 360;\n\t        scene.add(particle);\n\t        smokeParticles.push(particle);\n\t    }\t\n\t}\n\n\n\tfunction evolveSmoke() {\n\t    let sp = smokeParticles.length;\n\t    while(sp--) {\n\t        smokeParticles[sp].rotation.z += (delta * 0.2);\n\t    }\n\t}\n\n\tfunction buildHotspot() {\n\t\tTHREE.ImageUtils.crossOrigin = ''; \n\t\t\n\t\t// for ( let i = 0; i < 10; i ++ ) {\n\t\t\t\n\t\t\t// let logoTexture = THREE.ImageUtils.loadTexture('/textures/animus_red_logo.png');\n\t\t\t// logoTexture.crossOrigin = 'anonymous';\n\t\t\t\n\t\t\t// let logoMaterial = new THREE.MeshLambertMaterial({\n\t\t\t// \tcolor: 0xffffff, \n\t\t\t// \tmap: logoTexture, \n\t\t\t// \ttransparent: true\n\t\t\t// });\n\t\t\t\n\t\t\t// let logoGeo = new THREE.PlaneGeometry(40, 60);\n\t\t\t// // let hotspots = [];\n\t\t\t\n\t\t\t// hotspot = new THREE.Mesh(logoGeo, logoMaterial);\n\t\t\t\n\t\t\t// // hotspot.position.x = Math.random() * 800 - 400;\n\t\t\t// // hotspot.position.y = 0;\n\t\t\t// // hotspot.position.z = -400;\n\t\t\t// // \n\t\t\t// // hotspot.scale.x = Math.random() * 2 + 1;\n\t\t\t// // hotspot.scale.y = Math.random() * 2 + 1;\n\t\t\t// // hotspot.scale.z = Math.random() * 2 + 1;\n\t\t\t// // \n\t\t\t// // hotspot.rotation.x = Math.random() * 2 * Math.PI;\n\t\t\t// // hotspot.rotation.y = Math.random() * 2 * Math.PI;\n\t\t\t// // hotspot.rotation.z = Math.random() * 2 * Math.PI;\n\t\t\t// hotspot.position.set(-45, 0, -400);\n\t\t\t// // hotspot.rotation.x = 0.1;\n\t\t\t// scene.add(hotspot);\n\t\t\t\n\t\t\t// hotspots.push(hotspot)\t\t\n\t\t// }\t\n\t\t\n\t     let light = new THREE.DirectionalLight(0xffffff, 1.5);\n\t\t light.position.set(-1, 0, 1);\n\t\t scene.add(light);\n\t    // for (let p = 0; p < 50; p++) {\n\t    //     let particle = new THREE.Mesh(logoGeo, logoMaterial);\n\t    //     particle.position.set(Math.random()*500-250,Math.random()*500-250,Math.random()*1000-100);\n\t    //     particle.rotation.z = Math.random() * 360;\n\t    //     scene.add(particle);\n\t    //     hsParticles.push(particle);\n\t    // }\t\n\t}\n\n\tfunction evolveHotspot() {\n\t    let hs = hsParticles.length;\n\t    while(hs--) {\n\t        hsParticles[hs].rotation.z += (delta * 0.2);\n\t    }\n\t}\n\n\tfunction initRain() {\n\t\trainGeometry = new THREE.Geometry();\n\n\t\tlet sprite1 = THREE.ImageUtils.loadTexture( \"textures/rain1.png\" ),\n\t\tsprite2 = THREE.ImageUtils.loadTexture( \"textures/rain2.png\" ),\n\t\tsprite3 = THREE.ImageUtils.loadTexture( \"textures/rain3.png\" ),\n\t\tsprite4 = THREE.ImageUtils.loadTexture( \"textures/rain4.png\" ),\n\t\tsprite5 = THREE.ImageUtils.loadTexture( \"textures/rain5.png\" );\n\n\t\tfor (let i = 0; i < rainDensity; i++ ) {\n\t\t\tlet vertex = new THREE.Vector3();\n\t\t\tvertex.x = Math.random() * 2000 - 1000;\n\t\t\tvertex.y = Math.random() * 4000 + 500;\n\t\t\tvertex.z = Math.random() * 2000 - 1000;\n\n\t\t\trainGeometry.vertices.push( vertex );\n\t\t}\n\n\t\tparameters = [ [ [1.0, 0.2, 0.5], \tsprite2, 20 ],\n\t\t\t\t\t   [ [0.95, 0.1, 0.5], \tsprite3, 15 ],\n\t\t\t\t\t   [ [0.90, 0.05, 0.5], sprite1, 10 ],\n\t\t\t\t\t   [ [0.85, 0, 0.5], \tsprite5, 8 ],\n\t\t\t\t\t   [ [0.80, 0, 0.5], \tsprite4, 5 ],\n\t\t\t\t\t   ];\n\n\t\tfor (let i = 0; i < parameters.length; i++ ) {\n\n\t\t\tcolor  = parameters[i][0];\n\t\t\tsprite = parameters[i][1];\n\t\t\tsize   = parameters[i][2];\n\n\t\t\tmaterials[i] = new THREE.PointCloudMaterial({ \n\t\t\t\tsize: size, \n\t\t\t\tmap: sprite, \n\t\t\t\tblending: THREE.AdditiveBlending, \n\t\t\t\tdepthTest: false, \n\t\t\t\ttransparent : true \n\t\t\t});\n\t\t\tmaterials[i].color.setHSL( color[0], color[1], color[2] );\n\n\t\t\tparticles = new THREE.PointCloud( rainGeometry, materials[i] );\n\n\t\t\tparticles.rotation.z = Math.random() * 0.20 + 0.10;\n\n\t\t\tscene.add( particles );\n\t\t}\n\t}\n\n\tfunction animateRain() {\n\t\t// console.log(\"I'M ANIMATING THINGS\");\n\t\tlet time = Date.now() * 0.00005;\n\n\t\tfor (let i = 0; i < scene.children.length; i++ ) {\n\n\t\t\tlet object = scene.children[i];\n\t\t\t\n\t\t\tif ( object instanceof THREE.PointCloud ) {\n\t\t\t\t// Not getting into the log here\n\t\t\t\tconsole.log(\"I'M ANIMATING THINGS\");\n\t\t\t\tif (i == 0) {\n\t\t\t\t\tobject.translateY(-10);\n\t\t\t\t}\n\n\t\t\t\tif (i > 0) {\n\t\t\t\t\tif (layer)\n\t\t\t\t\t\tobject.translateY(-10);\n\t\t\t\t\telse\n\t\t\t\t\t\tif(scene.children[i-1].position.y < ((window.innerHeight * -1) / 2 - 1000))\n\t\t\t\t\t\t\tobject.translateY(-10);\n\t\t\t\t}\n\n\t\t\t\tif ((object.position.y < window.innerHeight * -1 * 5)) {\n\t\t\t\t\t\tobject.position.y = 500;\n\t\t\t\t\t\tobject.position.x = 0;\n\t\t\t\t\t\tif (i == 0) layer = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < materials.length; i++ ) {\n\n\t\t\tcolor = parameters[i][0];\n\n\t\t\th = ( 360 * ( color[0] + time ) % 360 ) / 360;\n\t\t\tmaterials[i].color.setHSL( h, color[1], color[2] );\n\n\t\t}\n\t}\n\n\tfunction onWindowResize() {\n\t\tcamera.aspect = window.innerWidth / window.innerHeight;\n\t\tcamera.updateProjectionMatrix();\n\t\trenderer.setSize( window.innerWidth, window.innerHeight );\n\t}\n\n\tfunction onDocumentTouchStart( event ) {\n\t\tevent.preventDefault();\n\t\tevent.clientX = event.touches[0].clientX;\n\t\tevent.clientY = event.touches[0].clientY;\n\t\tonDocumentMouseDown( event );\n\t}\n\n\tfunction onDocumentMouseDown( event ) {\n\t\traycaster.setFromCamera(mouse, camera);\n\t\tlet intersects = raycaster.intersectObjects(scene.children, true);\n\t\tintersects.forEach((intersect) => { \n\t\t\tlet object = intersect.object;\n\t\t\tif(object.name !== 'scene') {\n\t\t\t\tobject.parent.children[0].material.color.set(Math.random() * 0xffffff)\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction rotateHotspots() {\n\t\thotspots.forEach( hotspot => hotspot.rotation.y += rotateSpeed * 0.5 );\n\t}\n\n\tfunction onDocumentMouseMove( event ) {\n\t\tisUserInteracting = true;\n\t\tlon = event.clientX \n\t\t// if ( isUserInteracting === true ) {\n\t\t// \tlon = ( onPointerDownPointerX - event.clientX ) * 0.1 + onPointerDownLon;\n\t\t// \t// lat = ( event.clientY - onPointerDownPointerY ) * 0.1 + onPointerDownLat;\n\t\t// }\n\t}\n\n\tfunction onDocumentMouseUp( event ) {\n\t\tisUserInteracting = false;\n\t}\n\n\t// Zoom in & out | Need to limit this to the starting point and a endind point\n\tfunction onDocumentMouseWheel( event ) {\n\t\t// if (camera.fov > 75) {\n\t\t// \tcamera.fov = 75\n\t\t// } else {\n\t\t// \tcamera.fov += event.deltaY * 0.01;\n\t\t// \tcamera.updateProjectionMatrix();\n\t\t// }\n\t\tcamera.fov += event.deltaY * 0.02;\n\t\tcamera.updateProjectionMatrix();\n\t}\n\n\tfunction animate() {\n\t\trequestAnimationFrame( animate );\n\t\tupdate();\n\t\trenderer.setSize( window.innerWidth, window.innerHeight );\n\t}\n\n\tfunction update() {\n\t\t// if ( isUserInteracting === false ) {\n\t\t// \t// lon += 0.1;\n\t\t// }\n\t\tlat = Math.max( - 85, Math.min( 85, lat ) );\n\t\tphi = THREE.Math.degToRad( 90 - lat );\n\t\ttheta = THREE.Math.degToRad( lon );\n\n\t\tcamera.target.x = 500 * Math.sin( phi ) * Math.cos( theta );\n\t\t// camera.target.y = 500 * Math.cos( phi );\n\t\tcamera.target.z = 500 * Math.sin( phi ) * Math.sin( theta );\n\t\tcamera.lookAt( camera.target );\n\n\t\t/*\n\t\t// distortion\n\t\tcamera.position.copy( camera.target ).negate();\n\t\t*/\n\t\t// let delta = clock.getDelta(), speed = delta * CAMERAMOVESPEED;\n\t\t// controls.update(delta);\n\t\t// spotLight.target = marker;\n\t\t// controls.update()\n\t\t\n\t\t// spotLightHelper.update()\n\t\tstats.update()\n\t\tdelta = clock.getDelta();\n\n\t\tevolveSmoke();\n\t\tevolveHotspot();\n\t\tanimateRain();\n\t\t// rotateHotspot();\n\t\trotateHotspots();\n\t\t// rainEngine.update(0.01 * 0.5)\n\t\ttheta += 0.1;\n\t\t// let radius = 600;\n\t\t// camera.position.x = radius * Math.sin( THREE.Math.degToRad( theta ) );\n\t\t// camera.position.y = radius * Math.sin( THREE.Math.degToRad( theta ) );\n\t\t// camera.position.z = radius * Math.cos( THREE.Math.degToRad( theta ) );\n\t\t// camera.lookAt( scene.position );\n\t\tdeviceControls.update(delta);\n\t\t// deviceControls.connect();\n\t\trenderer.render( scene, camera );\n\t}\n\n\tfunction getPosition(event) {\n\t\tlet x = new Number();\n\t\tlet y = new Number();\n\t\t\n\t\tif (event.x != undefined && event.y != undefined) {\n\t\t\tx = event.x;\n\t\t\ty = event.y;\n\t\t} else { // Firefox method to get the position\n\t\t\tx = event.clientX + document.body.scrollLeft +\n\t\t\tdocument.documentElement.scrollLeft;\n\t\t\ty = event.clientY + document.body.scrollTop +\n\t\t\tdocument.documentElement.scrollTop;\n\t\t}\n\t\tx -= container.offsetLeft;\n\t\ty -= container.offsetTop;\t\n\t\t// alert(\"x: \" + x + \"  y: \" + y);\n\t\tconsole.log(\"x: \" + x + \"  y: \" + y);\n\t}\n\n\tfunction initStats() {\n\t\t// stats.setMode(0); // 0: fps, 1: ms\n\t\t// Align top-left\n\t\tstats = new Stats();\n\t\tstats.domElement.style.position = 'absolute';\n\t\t// stats.domElement.style.bottom = '0px';\n\t\tstats.domElement.style.left = '0px';\n\t\tstats.domElement.style.top = '0px';\n\t\tstats.domElement.style.zIndex = 100;\n\t\tcontainer.appendChild(stats.domElement);\n\t\treturn stats;\n\t}\n\n}, false);"]}